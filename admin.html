<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å EPIC KYC</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <style>
        :root {
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --success-color: #34c759;
            --warning-color: #ff9500;
            --danger-color: #ff3b30;
            --info-color: #5ac8fa;
            --dark-bg: #0a0a1a;
            --card-bg: rgba(255, 255, 255, 0.07);
            --border-color: rgba(102, 126, 234, 0.2);
            --sidebar-width: 250px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--dark-bg);
            color: #fff;
            height: 100vh;
            overflow: hidden;
        }

        .admin-container {
            display: flex;
            height: 100vh;
        }

        /* –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å */
        .sidebar {
            width: var(--sidebar-width);
            background: rgba(15, 15, 30, 0.95);
            border-right: 1px solid var(--border-color);
            padding: 20px 0;
            display: flex;
            flex-direction: column;
            transition: width 0.3s;
            flex-shrink: 0;
        }

        .sidebar.collapsed {
            width: 70px;
        }

        .sidebar.collapsed .logo h1,
        .sidebar.collapsed .admin-info .admin-nickname,
        .sidebar.collapsed .admin-info .admin-role,
        .sidebar.collapsed .nav-item span,
        .sidebar.collapsed .logout-btn span {
            display: none;
        }

        .sidebar.collapsed .logo {
            padding: 20px 10px;
        }

        .modal-content {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            margin: 20px auto;
            max-width: 1200px;
            border: 1px solid var(--border-color);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }


        .sidebar.collapsed .admin-info {
            padding: 15px 10px;
        }

        .sidebar.collapsed .admin-avatar {
            width: 40px;
            height: 40px;
            font-size: 18px;
        }

        .sidebar.collapsed .nav-item {
            padding: 12px;
            justify-content: center;
        }

        .sidebar.collapsed .nav-item i {
            margin: 0;
        }

        .sidebar.collapsed .logout-btn {
            padding: 12px;
            justify-content: center;
        }

        .toggle-sidebar {
            position: absolute;
            top: 20px;
            right: -12px;
            width: 24px;
            height: 24px;
            background: var(--primary-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 12px;
            z-index: 100;
            box-shadow: 0 2px 10px rgba(102, 126, 234, 0.3);
        }

        .logo {
            padding: 0 20px 20px;
            text-align: center;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 20px;
            position: relative;
        }

        .logo h1 {
            font-size: 20px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-top: 10px;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto;
            font-size: 20px;
        }

        .admin-info {
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 20px;
            position: relative;
        }

        .admin-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            margin: 0 auto 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            position: relative;
        }

        .admin-online {
            position: absolute;
            bottom: 5px;
            right: 5px;
            width: 12px;
            height: 12px;
            background: var(--success-color);
            border-radius: 50%;
            border: 2px solid rgba(15, 15, 30, 0.95);
        }

        .admin-nickname {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .admin-role {
            font-size: 11px;
            opacity: 0.7;
            background: rgba(102, 126, 234, 0.2);
            padding: 2px 8px;
            border-radius: 10px;
            display: inline-block;
        }

        .nav-menu {
            flex: 1;
            padding: 0 10px;
            overflow-y: auto;
        }

        .nav-item {
            padding: 12px 15px;
            margin: 5px 0;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
            position: relative;
            white-space: nowrap;
        }

        .nav-item:hover {
            background: rgba(102, 126, 234, 0.1);
        }

        .nav-item.active {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.2), rgba(118, 75, 162, 0.2));
            border-left: 3px solid var(--primary-color);
        }

        .nav-item i {
            width: 20px;
            text-align: center;
            font-size: 16px;
            flex-shrink: 0;
        }

        .nav-item span {
            flex: 1;
            font-size: 14px;
            font-weight: 500;
        }

        .notification-badge {
            background: var(--danger-color);
            color: white;
            font-size: 11px;
            font-weight: 600;
            padding: 2px 6px;
            border-radius: 10px;
            min-width: 18px;
            text-align: center;
        }

        .logout-btn {
            margin: 20px;
            padding: 12px;
            background: rgba(255, 59, 48, 0.1);
            border: 1px solid rgba(255, 59, 48, 0.3);
            border-radius: 10px;
            color: var(--danger-color);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s;
            font-weight: 500;
        }

        .logout-btn:hover {
            background: rgba(255, 59, 48, 0.2);
        }

        /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            min-width: 0;
        }

        .top-bar {
            padding: 15px 25px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(15, 15, 30, 0.9);
            flex-shrink: 0;
        }

        .search-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .search-box {
            width: 300px;
            padding: 10px 15px;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: #fff;
            font-size: 14px;
        }

        .search-box:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .top-bar-stats {
            display: flex;
            align-items: center;
            gap: 20px;
            font-size: 14px;
        }

        .online-indicator {
            display: flex;
            align-items: center;
            gap: 5px;
            color: var(--success-color);
        }

        .online-dot {
            width: 8px;
            height: 8px;
            background: var(--success-color);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .stats-bar {
            display: flex;
            gap: 20px;
            padding: 15px 25px;
            border-bottom: 1px solid var(--border-color);
            background: rgba(15, 15, 30, 0.8);
            flex-wrap: wrap;
            flex-shrink: 0;
        }

        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 120px;
        }

        .stat-value {
            font-size: 24px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            font-size: 12px;
            opacity: 0.7;
            text-align: center;
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞ */
        .content-area {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            min-height: 0;
        }

        .section-title {
            font-size: 20px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* –ö–∞—Ä—Ç–æ—á–∫–∏ –∑–∞–∫–∞–∑–æ–≤ */
        .orders-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .order-card {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
        }

        .order-card:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.1);
        }

        .order-card.selected {
            border-color: var(--primary-color);
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .order-id {
            font-family: 'Courier New', monospace;
            font-size: 14px;
            opacity: 0.8;
            font-weight: 600;
        }

        .order-status {
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            white-space: nowrap;
        }

        .status-pending { background: rgba(255, 149, 0, 0.2); color: var(--warning-color); }
        .status-paid { background: rgba(52, 199, 89, 0.2); color: var(--success-color); }
        .status-waiting_verification { background: rgba(0, 122, 255, 0.2); color: #007aff; }
        .status-verification_submitted { background: rgba(88, 86, 214, 0.2); color: #5856d6; }
        .status-in_progress { background: rgba(90, 200, 250, 0.2); color: var(--info-color); }
        .status-completed { background: rgba(52, 199, 89, 0.2); color: var(--success-color); }
        .status-cancelled { background: rgba(255, 59, 48, 0.2); color: var(--danger-color); }

        .order-info {
            margin-bottom: 15px;
        }

        .order-info-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .order-info-label {
            opacity: 0.7;
            min-width: 100px;
        }

        .order-info-value {
            font-weight: 500;
            text-align: right;
            flex: 1;
        }

        .order-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .order-badges {
            display: flex;
            gap: 8px;
        }

        .order-badge {
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .badge-taken {
            background: rgba(102, 126, 234, 0.2);
            color: var(--primary-color);
        }

        .badge-unread {
            background: rgba(255, 59, 48, 0.2);
            color: var(--danger-color);
        }

        .badge-new {
            background: rgba(255, 149, 0, 0.2);
            color: var(--warning-color);
        }

        .order-actions {
            display: flex;
            gap: 8px;
        }

        .btn {
            padding: 6px 12px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 5px;
            white-space: nowrap;
        }

        .btn-sm {
            padding: 4px 8px;
            font-size: 11px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-warning {
            background: var(--warning-color);
            color: white;
        }

        .btn-danger {
            background: var(--danger-color);
            color: white;
        }

        .btn-info {
            background: var(--info-color);
            color: white;
        }

        .btn:hover {
            opacity: 0.9;
            transform: translateY(-1px);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* –î–µ—Ç–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ –∑–∞–∫–∞–∑–∞ */
        .order-detail-container {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
        }

        .detail-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .detail-title {
            font-size: 22px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .detail-actions {
            display: flex;
            gap: 10px;
        }

        .detail-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .detail-section {
            background: rgba(0, 0, 0, 0.2);
            padding: 20px;
            border-radius: 8px;
        }

        .detail-section h3 {
            font-size: 16px;
            margin-bottom: 15px;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .detail-item {
            margin-bottom: 12px;
            display: flex;
            justify-content: space-between;
        }

        .detail-label {
            font-size: 13px;
            opacity: 0.7;
            min-width: 120px;
        }

        .detail-value {
            font-size: 14px;
            font-weight: 600;
            text-align: right;
            flex: 1;
            word-break: break-word;
        }

        /* –í–∫–ª–∞–¥–∫–∏ */
        .tabs {
            display: flex;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .tab {
            padding: 12px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.3s;
            font-weight: 500;
            position: relative;
        }

        .tab:hover {
            background: rgba(102, 126, 234, 0.1);
        }

        .tab.active {
            border-bottom-color: var(--primary-color);
            color: var(--primary-color);
        }

        .tab-badge {
            position: absolute;
            top: 5px;
            right: 5px;
            background: var(--danger-color);
            color: white;
            font-size: 10px;
            padding: 1px 4px;
            border-radius: 8px;
            min-width: 16px;
            text-align: center;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* –ß–∞—Ç */
        .chat-container {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            height: 400px;
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 20px;
            padding-right: 10px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .chat-message {
            max-width: 80%;
            padding: 10px;
            border-radius: 12px;
            position: relative;
        }

        .message-user {
            align-self: flex-end;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.3), rgba(118, 75, 162, 0.3));
            border-bottom-right-radius: 4px;
        }

        .message-admin {
            align-self: flex-start;
            background: rgba(0, 0, 0, 0.3);
            border-bottom-left-radius: 4px;
        }

        .message-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 5px;
            font-size: 12px;
        }

        .message-sender {
            font-weight: 600;
            color: var(--primary-color);
        }

        .message-time {
            opacity: 0.6;
        }

        .message-content {
            font-size: 14px;
            line-height: 1.5;
            word-break: break-word;
        }

        .message-file {
            margin-top: 8px;
            padding: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .chat-input-area {
            display: flex;
            gap: 10px;
            align-items: flex-end;
        }

        .chat-input {
            flex: 1;
            padding: 12px 15px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: white;
            resize: none;
            font-family: inherit;
            font-size: 14px;
            min-height: 50px;
            max-height: 150px;
        }

        .chat-input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .chat-actions {
            display: flex;
            gap: 5px;
        }

        /* –¢–∞–±–ª–∏—Ü—ã */
        .table-container {
            overflow-x: auto;
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 600px;
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
            vertical-align: top;
        }

        th {
            font-weight: 600;
            font-size: 13px;
            opacity: 0.8;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        tr:hover {
            background: rgba(102, 126, 234, 0.05);
        }

        /* –§–∏–ª—å—Ç—Ä—ã */
        .filters-container {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .filters-row {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .filter-group {
            flex: 1;
            min-width: 200px;
        }

        .filter-label {
            display: block;
            margin-bottom: 8px;
            font-size: 13px;
            opacity: 0.8;
            font-weight: 500;
        }

        .filter-select, .filter-input {
            width: 100%;
            padding: 10px 15px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: white;
            font-size: 14px;
        }

        .filter-select:focus, .filter-input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .filter-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* –ü–∞–≥–∏–Ω–∞—Ü–∏—è */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 30px;
        }

        .pagination-btn {
            padding: 8px 16px;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 14px;
        }

        .pagination-btn:hover:not(:disabled) {
            background: rgba(102, 126, 234, 0.1);
            border-color: var(--primary-color);
        }

        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .pagination-info {
            font-size: 14px;
            opacity: 0.7;
            min-width: 150px;
            text-align: center;
        }

        /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
        }

        .stat-card h3 {
            font-size: 16px;
            margin-bottom: 15px;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .stat-value-large {
            font-size: 36px;
            font-weight: 800;
            margin: 10px 0;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-trend {
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .trend-up {
            color: var(--success-color);
        }

        .trend-down {
            color: var(--danger-color);
        }

        /* –ù–∞—Å—Ç—Ä–æ–π–∫–∏ */
        .settings-container {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 30px;
            max-width: 600px;
            margin: 0 auto;
        }

        .settings-group {
            margin-bottom: 30px;
        }

        .settings-group h3 {
            font-size: 18px;
            margin-bottom: 20px;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .settings-item {
            margin-bottom: 20px;
        }

        .settings-label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            font-weight: 500;
        }

        .settings-hint {
            font-size: 12px;
            opacity: 0.7;
            margin-top: 5px;
            line-height: 1.5;
        }

        /* –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        .notification-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-width: 350px;
        }

        .notification {
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 15px;
            display: flex;
            align-items: flex-start;
            gap: 10px;
            animation: slideIn 0.3s ease-out;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .notification-icon {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .notification-success .notification-icon {
            background: rgba(52, 199, 89, 0.2);
            color: var(--success-color);
        }

        .notification-error .notification-icon {
            background: rgba(255, 59, 48, 0.2);
            color: var(--danger-color);
        }

        .notification-info .notification-icon {
            background: rgba(90, 200, 250, 0.2);
            color: var(--info-color);
        }

        .notification-warning .notification-icon {
            background: rgba(255, 149, 0, 0.2);
            color: var(--warning-color);
        }

        .notification-content {
            flex: 1;
        }

        .notification-title {
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 14px;
        }

        .notification-message {
            font-size: 13px;
            opacity: 0.9;
            line-height: 1.4;
        }

        .notification-close {
            background: none;
            border: none;
            color: rgba(255, 255, 255, 0.5);
            cursor: pointer;
            font-size: 12px;
            padding: 0;
            flex-shrink: 0;
        }

        .notification-close:hover {
            color: white;
        }

        /* –ó–∞–≥—Ä—É–∑–∫–∞ */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 40px;
            font-size: 14px;
            opacity: 0.7;
        }

        .loading-spinner {
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-top-color: var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 1200px) {
            .orders-grid {
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            }
        }

        @media (max-width: 992px) {
            .sidebar {
                position: fixed;
                left: 0;
                top: 0;
                bottom: 0;
                z-index: 1000;
                transform: translateX(-100%);
                transition: transform 0.3s;
            }

            .sidebar.show {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .mobile-menu-toggle {
                display: block;
                position: fixed;
                top: 15px;
                left: 15px;
                z-index: 1001;
                background: var(--primary-color);
                color: white;
                width: 40px;
                height: 40px;
                border-radius: 8px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 20px;
                cursor: pointer;
                box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
            }

            .toggle-sidebar {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .orders-grid {
                grid-template-columns: 1fr;
            }

            .stats-bar {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }

            .stat-item {
                min-width: auto;
                width: 100%;
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
            }

            .top-bar {
                flex-direction: column;
                gap: 15px;
                align-items: stretch;
            }

            .search-container {
                width: 100%;
            }

            .search-box {
                width: 100%;
            }

            .top-bar-stats {
                justify-content: center;
            }

            .detail-grid {
                grid-template-columns: 1fr;
            }

            .filters-row {
                flex-direction: column;
            }

            .filter-group {
                min-width: 100%;
            }
        }

        @media (max-width: 480px) {
            .content-area {
                padding: 15px;
            }

            .section-title {
                font-size: 18px;
            }

            .order-actions {
                flex-direction: column;
                width: 100%;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }

            .detail-actions {
                flex-direction: column;
                width: 100%;
            }

            .chat-container {
                height: 300px;
                padding: 15px;
            }

            .tab {
                padding: 10px 15px;
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <div class="notification-container" id="notificationContainer"></div>

    <!-- –ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é -->
    <div class="mobile-menu-toggle" onclick="toggleMobileMenu()" id="mobileMenuToggle">
        <i class="fas fa-bars"></i>
    </div>

    <div class="admin-container">
        <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
        <div class="sidebar" id="sidebar">
            <div class="toggle-sidebar" onclick="toggleSidebar()">
                <i class="fas fa-chevron-left" id="sidebarToggleIcon"></i>
            </div>
            
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-user-shield"></i>
                </div>
                <h1>EPIC KYC Admin</h1>
            </div>
            
            <div class="admin-info">
                <div class="admin-avatar">
                    <i class="fas fa-user"></i>
                    <div class="admin-online"></div>
                </div>
                <div class="admin-nickname" id="adminNickname">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                <div class="admin-role" id="adminRole">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</div>
            </div>
            
            <div class="nav-menu">
                <div class="nav-item active" data-section="orders" onclick="showSection('orders')">
                    <i class="fas fa-shopping-cart"></i>
                    <span>–ó–∞–∫–∞–∑—ã</span>
                    <span class="notification-badge" id="ordersBadge" style="display: none;">0</span>
                </div>
                <div class="nav-item" data-section="dashboard" onclick="showSection('dashboard')">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>–î–∞—à–±–æ—Ä–¥</span>
                </div>
                <div class="nav-item" data-section="statistics" onclick="showSection('statistics')">
                    <i class="fas fa-chart-bar"></i>
                    <span>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</span>
                </div>
                <div class="nav-item" data-section="settings" onclick="showSection('settings')">
                    <i class="fas fa-cog"></i>
                    <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
                </div>
            </div>
            
            <div class="logout-btn" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i>
                <span>–í—ã–π—Ç–∏</span>
            </div>
        </div>
        
        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <div class="main-content">
            <div class="top-bar">
                <div class="search-container">
                    <input type="text" class="search-box" placeholder="–ü–æ–∏—Å–∫ –ø–æ ID –∑–∞–∫–∞–∑–∞ –∏–ª–∏ –∫–ª–∏–µ–Ω—Ç—É..." id="searchInput">
                </div>
                
                <div class="top-bar-stats">
                    <div class="online-indicator" id="onlineIndicator">
                        <div class="online-dot"></div>
                        <span id="onlineCount">1</span> –æ–Ω–ª–∞–π–Ω
                    </div>
                    <div style="font-size: 14px; opacity: 0.8;">
                        <i class="fas fa-clock"></i>
                        <span id="currentTime">--:--</span>
                    </div>
                </div>
            </div>
            
            <div class="stats-bar" id="statsBar" style="display: none;">
                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
            
            <!-- –§–∏–ª—å—Ç—Ä—ã (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–∞–∑–¥–µ–ª–∞ –∑–∞–∫–∞–∑–æ–≤) -->
            <div class="filters-container" id="filtersContainer" style="display: none;">
                <div class="filters-row">
                    <div class="filter-group">
                        <label class="filter-label">–°—Ç–∞—Ç—É—Å</label>
                        <select class="filter-select" id="statusFilter">
                            <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                            <option value="pending">‚è≥ –û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã</option>
                            <option value="paid">üí≥ –û–ø–ª–∞—á–µ–Ω</option>
                            <option value="waiting_verification">üìù –ñ–¥–µ—Ç –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏</option>
                            <option value="verification_submitted">üì§ –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã</option>
                            <option value="in_progress">üîÑ –í —Ä–∞–±–æ—Ç–µ</option>
                            <option value="completed">‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω</option>
                            <option value="cancelled">‚ùå –û—Ç–º–µ–Ω–µ–Ω</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label class="filter-label">–ë–∏—Ä–∂–∞</label>
                        <select class="filter-select" id="exchangeFilter">
                            <option value="">–í—Å–µ –±–∏—Ä–∂–∏</option>
                            <option value="binance">Binance</option>
                            <option value="bybit">Bybit</option>
                            <option value="okx">OKX</option>
                            <option value="kucoin">KuCoin</option>
                            <option value="gateio">Gate.io</option>
                            <option value="mexc">MEXC</option>
                            <option value="weex">Weex</option>
                            <option value="bingx">BingX</option>
                            <option value="bitget">Bitget</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label class="filter-label">–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</label>
                        <select class="filter-select" id="adminFilter">
                            <option value="">–í—Å–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã</option>
                            <option value="0">–ù–µ –≤–∑—è—Ç—ã–µ</option>
                        </select>
                    </div>
                </div>
                
                <div class="filter-actions">
                    <button class="btn btn-primary" onclick="applyFilters()">
                        <i class="fas fa-filter"></i> –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
                    </button>
                    <button class="btn" onclick="resetFilters()">
                        <i class="fas fa-redo"></i> –°–±—Ä–æ—Å–∏—Ç—å
                    </button>
                </div>
            </div>
            
            <!-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞ -->
            <div class="content-area" id="contentArea">
                <!-- –†–∞–∑–¥–µ–ª –∑–∞–∫–∞–∑–æ–≤ -->
                <div id="ordersSection" class="section-content">
                    <div class="section-title">
                        <i class="fas fa-shopping-cart"></i>
                        <span>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞–º–∏</span>
                    </div>
                    
                    <div class="orders-grid" id="ordersGrid">
                        <!-- –ó–∞–∫–∞–∑—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                    
                    <div class="loading" id="ordersLoading">
                        <div class="loading-spinner"></div>
                        <span>–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–∫–∞–∑–æ–≤...</span>
                    </div>
                    
                    <div class="no-data" id="noOrdersMessage" style="display: none; text-align: center; padding: 40px 20px; opacity: 0.7;">
                        <div style="font-size: 48px; margin-bottom: 20px;">
                            <i class="fas fa-inbox"></i>
                        </div>
                        <div style="font-size: 18px; margin-bottom: 10px; font-weight: 600;">
                            –ù–µ—Ç –∑–∞–∫–∞–∑–æ–≤ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
                        </div>
                        <div style="font-size: 14px;">
                            –ò–∑–º–µ–Ω–∏—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã –∏–ª–∏ –ø–æ–¥–æ–∂–¥–∏—Ç–µ –Ω–æ–≤—ã—Ö –∑–∞–∫–∞–∑–æ–≤
                        </div>
                    </div>
                    
                    <div class="pagination" id="pagination" style="display: none;">
                        <button class="pagination-btn" onclick="changePage(-1)" id="prevPageBtn" disabled>
                            <i class="fas fa-chevron-left"></i> –ù–∞–∑–∞–¥
                        </button>
                        <div class="pagination-info" id="pageInfo">–°—Ç—Ä–∞–Ω–∏—Ü–∞ 1 –∏–∑ 1</div>
                        <button class="pagination-btn" onclick="changePage(1)" id="nextPageBtn" disabled>
                            –í–ø–µ—Ä–µ–¥ <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
                
                <!-- –†–∞–∑–¥–µ–ª –¥–∞—à–±–æ—Ä–¥–∞ -->
                <div id="dashboardSection" class="section-content" style="display: none;">
                    <div class="section-title">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>–î–∞—à–±–æ—Ä–¥</span>
                    </div>
                    
                    <div class="stats-grid" id="dashboardStats">
                        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                    
                    <div class="loading" id="dashboardLoading">
                        <div class="loading-spinner"></div>
                        <span>–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏...</span>
                    </div>
                    
                    <div class="section-title" style="margin-top: 30px;">
                        <i class="fas fa-bell"></i>
                        <span>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</span>
                    </div>
                    
                    <div class="table-container">
                        <table id="recentActivities">
                            <thead>
                                <tr>
                                    <th>–í—Ä–µ–º—è</th>
                                    <th>–î–µ–π—Å—Ç–≤–∏–µ</th>
                                    <th>–ó–∞–∫–∞–∑</th>
                                    <th>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</th>
                                </tr>
                            </thead>
                            <tbody id="activitiesTable">
                                <!-- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- –†–∞–∑–¥–µ–ª —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ -->
                <div id="statisticsSection" class="section-content" style="display: none;">
                    <div class="section-title">
                        <i class="fas fa-chart-bar"></i>
                        <span>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</span>
                    </div>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3><i class="fas fa-user-check"></i> –ú–æ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                            <div id="myStats">
                                <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <h3><i class="fas fa-users"></i> –ê–∫—Ç–∏–≤–Ω—ã–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã</h3>
                            <div id="activeAdmins">
                                <!-- –ê–∫—Ç–∏–≤–Ω—ã–µ –∞–¥–º–∏–Ω—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                            </div>
                        </div>
                    </div>
                    
                    <div class="loading" id="statsLoading">
                        <div class="loading-spinner"></div>
                        <span>–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏...</span>
                    </div>
                </div>
                
                <!-- –†–∞–∑–¥–µ–ª –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
                <div id="settingsSection" class="section-content" style="display: none;">
                    <div class="section-title">
                        <i class="fas fa-cog"></i>
                        <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è</span>
                    </div>
                    
                    <div class="settings-container">
                        <div class="settings-group">
                            <h3><i class="fas fa-user-edit"></i> –õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</h3>
                            
                            <div class="settings-item">
                                <label class="settings-label">–í–∞—à –ø—Å–µ–≤–¥–æ–Ω–∏–º</label>
                                <input type="text" class="filter-input" id="nicknameInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –ø—Å–µ–≤–¥–æ–Ω–∏–º">
                                <div class="settings-hint">
                                    –≠—Ç–æ—Ç –ø—Å–µ–≤–¥–æ–Ω–∏–º –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤ —á–∞—Ç–µ –∏ –∏—Å—Ç–æ—Ä–∏–∏ –¥–µ–π—Å—Ç–≤–∏–π
                                </div>
                            </div>
                        </div>
                        
                        <div class="settings-group">
                            <h3><i class="fas fa-bell"></i> –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h3>
                            
                            <div class="settings-item">
                                <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                    <input type="checkbox" id="notifyNewOrders" checked style="width: auto;">
                                    <span>–ù–æ–≤—ã–µ –∑–∞–∫–∞–∑—ã</span>
                                </label>
                                <div class="settings-hint">
                                    –ü–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö –∑–∞–∫–∞–∑–∞—Ö
                                </div>
                            </div>
                            
                            <div class="settings-item">
                                <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                    <input type="checkbox" id="notifyNewMessages" checked style="width: auto;">
                                    <span>–ù–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è</span>
                                </label>
                                <div class="settings-hint">
                                    –ü–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –Ω–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –≤ —á–∞—Ç–µ
                                </div>
                            </div>
                            
                            <div class="settings-item">
                                <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                                    <input type="checkbox" id="notifyVerificationData" checked style="width: auto;">
                                    <span>–î–∞–Ω–Ω—ã–µ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏</span>
                                </label>
                                <div class="settings-hint">
                                    –ü–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
                                </div>
                            </div>
                        </div>
                        
                        <div class="settings-group">
                            <h3><i class="fas fa-palette"></i> –í–Ω–µ—à–Ω–∏–π –≤–∏–¥</h3>
                            
                            <div class="settings-item">
                                <label class="settings-label">–¢–µ–º–∞</label>
                                <select class="filter-select" id="themeSelect">
                                    <option value="dark">–¢–µ–º–Ω–∞—è</option>
                                    <option value="light">–°–≤–µ—Ç–ª–∞—è</option>
                                    <option value="auto">–ê–≤—Ç–æ</option>
                                </select>
                            </div>
                            
                            <div class="settings-item">
                                <label class="settings-label">–ü–ª–æ—Ç–Ω–æ—Å—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</label>
                                <select class="filter-select" id="densitySelect">
                                    <option value="comfortable">–ö–æ–º—Ñ–æ—Ä—Ç–Ω–∞—è</option>
                                    <option value="compact">–ö–æ–º–ø–∞–∫—Ç–Ω–∞—è</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="filter-actions">
                            <button class="btn btn-primary" onclick="saveSettings()" style="width: 100%; padding: 12px;">
                                <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–µ—Ç–∞–ª–µ–π –∑–∞–∫–∞–∑–∞ -->
    <div id="orderDetailModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.95); z-index: 2000; overflow-y: auto;">
        <div style="max-width: 1200px; margin: 20px auto; padding: 20px;">
            <div class="order-detail-container">
                <div class="detail-header">
                    <div class="detail-title">
                        <i class="fas fa-file-invoice"></i>
                        <span>–ó–∞–∫–∞–∑ <span id="detailOrderId">#000000</span></span>
                    </div>
                    <div class="detail-actions">
                        <button class="btn btn-primary" onclick="closeOrderDetail()">
                            <i class="fas fa-times"></i> –ó–∞–∫—Ä—ã—Ç—å
                        </button>
                    </div>
                </div>
                
                <div class="detail-grid">
                    <div class="detail-section">
                        <h3><i class="fas fa-info-circle"></i> –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                        <div class="detail-item">
                            <div class="detail-label">–°—Ç–∞—Ç—É—Å:</div>
                            <div class="detail-value" id="detailStatus"></div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">–ë–∏—Ä–∂–∞:</div>
                            <div class="detail-value" id="detailExchange"></div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">–£—Å–ª—É–≥–∞:</div>
                            <div class="detail-value" id="detailService"></div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</div>
                            <div class="detail-value" id="detailQuantity"></div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">–°—Ç—Ä–∞–Ω–∞:</div>
                            <div class="detail-value" id="detailCountry"></div>
                        </div>
                    </div>
                    
                    <div class="detail-section">
                        <h3><i class="fas fa-money-bill-wave"></i> –§–∏–Ω–∞–Ω—Å—ã</h3>
                        <div class="detail-item">
                            <div class="detail-label">–°—É–º–º–∞:</div>
                            <div class="detail-value" id="detailAmount"></div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">–ö—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–∞:</div>
                            <div class="detail-value" id="detailCrypto"></div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">–°–µ—Ç—å:</div>
                            <div class="detail-value" id="detailNetwork"></div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">–ö–æ—à–µ–ª–µ–∫:</div>
                            <div class="detail-value" id="detailWallet" style="font-family: monospace; font-size: 12px;"></div>
                        </div>
                    </div>
                    
                    <div class="detail-section">
                        <h3><i class="fas fa-user"></i> –ö–ª–∏–µ–Ω—Ç</h3>
                        <div class="detail-item">
                            <div class="detail-label">ID:</div>
                            <div class="detail-value" id="detailUserId"></div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">–ò–º—è:</div>
                            <div class="detail-value" id="detailUserName"></div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">–¢–µ–ª–µ–≥—Ä–∞–º:</div>
                            <div class="detail-value" id="detailUserTelegram"></div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:</div>
                            <div class="detail-value" id="detailCreatedAt"></div>
                        </div>
                    </div>
                </div>
                
                <div class="tabs">
                    <div class="tab active" data-tab="chat" onclick="showDetailTab('chat')">
                        <i class="fas fa-comments"></i> –ß–∞—Ç
                        <span class="tab-badge" id="chatTabBadge" style="display: none;">0</span>
                    </div>
                    <div class="tab" data-tab="verification" onclick="showDetailTab('verification')">
                        <i class="fas fa-id-card"></i> –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è
                    </div>
                    <div class="tab" data-tab="history" onclick="showDetailTab('history')">
                        <i class="fas fa-history"></i> –ò—Å—Ç–æ—Ä–∏—è
                    </div>
                    <div class="tab" data-tab="actions" onclick="showDetailTab('actions')">
                        <i class="fas fa-cogs"></i> –î–µ–π—Å—Ç–≤–∏—è
                    </div>
                </div>
                
                <!-- –í–∫–ª–∞–¥–∫–∞ —á–∞—Ç–∞ -->
                <div id="chatTabContent" class="tab-content active">
                    <div class="chat-container">
                        <div class="chat-messages" id="detailChatMessages">
                            <!-- –°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                        </div>
                        
                        <div class="chat-input-area">
                            <textarea 
                                class="chat-input" 
                                placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." 
                                rows="2"
                                id="detailChatInput"
                                onkeydown="handleChatInputKeydown(event)"
                            ></textarea>
                            <div class="chat-actions">
                                <button class="btn btn-primary" onclick="sendChatMessage()">
                                    <i class="fas fa-paper-plane"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- –í–∫–ª–∞–¥–∫–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ -->
                <div id="verificationTabContent" class="tab-content">
                    <div id="verificationDataContent">
                        <!-- –î–∞–Ω–Ω—ã–µ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                    </div>
                </div>
                
                <!-- –í–∫–ª–∞–¥–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ -->
                <div id="historyTabContent" class="tab-content">
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>–í—Ä–µ–º—è</th>
                                    <th>–î–µ–π—Å—Ç–≤–∏–µ</th>
                                    <th>–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä</th>
                                    <th>–î–µ—Ç–∞–ª–∏</th>
                                </tr>
                            </thead>
                            <tbody id="detailHistoryTable">
                                <!-- –ò—Å—Ç–æ—Ä–∏—è –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- –í–∫–ª–∞–¥–∫–∞ –¥–µ–π—Å—Ç–≤–∏–π -->
                <div id="actionsTabContent" class="tab-content">
                    <div style="padding: 20px; text-align: center;">
                        <h3 style="margin-bottom: 20px; color: var(--primary-color);">–î–µ–π—Å—Ç–≤–∏—è —Å –∑–∞–∫–∞–∑–æ–º</h3>
                        
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 30px;">
                            <button class="btn btn-success" onclick="confirmPayment()" id="confirmPaymentBtn" style="padding: 12px;">
                                <i class="fas fa-check-circle"></i> –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ–ø–ª–∞—Ç—É
                            </button>
                            
                            <button class="btn btn-warning" onclick="takeOrderAction()" id="takeOrderBtn" style="padding: 12px;">
                                <i class="fas fa-hand-paper"></i> –í–∑—è—Ç—å –∑–∞–∫–∞–∑
                            </button>
                            
                            <button class="btn btn-info" onclick="completeOrderAction()" id="completeOrderBtn" style="padding: 12px;">
                                <i class="fas fa-flag-checkered"></i> –ó–∞–≤–µ—Ä—à–∏—Ç—å
                            </button>
                            
                            <button class="btn btn-danger" onclick="cancelOrderAction()" style="padding: 12px;">
                                <i class="fas fa-times-circle"></i> –û—Ç–º–µ–Ω–∏—Ç—å
                            </button>
                        </div>
                        
                        <div style="background: rgba(0, 0, 0, 0.2); padding: 15px; border-radius: 8px; text-align: left;">
                            <h4 style="margin-bottom: 10px; color: var(--warning-color);">
                                <i class="fas fa-exclamation-triangle"></i> –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–∫–∞–∑–µ
                            </h4>
                            <div style="font-size: 14px; line-height: 1.5;">
                                <p>‚Ä¢ –î–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ–ø–ª–∞—Ç—ã –∑–∞–∫–∞–∑ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Å—Ç–∞—Ç—É—Å–µ "–û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã"</p>
                                <p>‚Ä¢ –î–ª—è –≤–∑—è—Ç–∏—è –∑–∞–∫–∞–∑–∞ - –∑–∞–∫–∞–∑ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–≤–æ–±–æ–¥–µ–Ω</p>
                                <p>‚Ä¢ –î–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è - –∑–∞–∫–∞–∑ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Ä–∞–±–æ—Ç–µ</p>
                                <p>‚Ä¢ –û—Ç–º–µ–Ω–∞ –∑–∞–∫–∞–∑–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ –ª—é–±–æ–º —Å—Ç–∞—Ç—É—Å–µ</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid var(--border-color);">
                    <div style="font-size: 12px; opacity: 0.7; text-align: center;">
                        –ó–∞–∫–∞–∑ ID: <span id="detailFullOrderId" style="font-family: monospace;"></span>
                        ‚Ä¢ –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: <span id="detailLastUpdate">--:--</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
        const API_BASE_URL = 'https://saran-furcular-katlyn.ngrok-free.dev/api';
        const WS_URL = 'wss://saran-furcular-katlyn.ngrok-free.dev';
        
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let currentAdmin = null;
        let currentOrder = null;
        let orders = [];
        let currentPage = 1;
        let totalPages = 1;
        let limit = 12;
        let filters = {};
        let socket = null;
        let isSidebarCollapsed = false;
        let notificationSound = null;
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', async function() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
            const adminId = localStorage.getItem('admin_id');
            const adminToken = localStorage.getItem('admin_token');
            
            if (!adminId || !adminToken) {
                window.location.href = '/admin-login';
                return;
            }
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ç–µ–∫—É—â–µ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
            currentAdmin = {
                id: adminId,
                token: adminToken,
                nickname: localStorage.getItem('admin_nickname') || '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä',
                username: localStorage.getItem('admin_username'),
                role: localStorage.getItem('admin_role') || 'admin'
            };
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            document.getElementById('adminNickname').textContent = currentAdmin.nickname;
            document.getElementById('adminRole').textContent = currentAdmin.role === 'superadmin' ? '–°—É–ø–µ—Ä-–∞–¥–º–∏–Ω' : '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä';
            
            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º WebSocket
            setupWebSocket();
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            await loadDashboardStats();
            await loadOrders();
            await loadOnlineAdmins();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è
            updateCurrentTime();
            setInterval(updateCurrentTime, 60000);
            
            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø–æ–∏—Å–∫
            setupSearch();
            
            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
            setupEventListeners();
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
            loadStoredSettings();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏
            showNotification('–£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥', '–í—ã —É—Å–ø–µ—à–Ω–æ –≤–æ—à–ª–∏ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å', 'success');
        });
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ WebSocket
        function setupWebSocket() {
            try {
                socket = io(WS_URL, {
                    transports: ['websocket', 'polling'],
                    reconnection: true,
                    reconnectionAttempts: 5,
                    reconnectionDelay: 1000
                });
                
                socket.on('connect', function() {
                    console.log('WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω');
                    
                    // –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–µ–º—Å—è –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä
                    socket.emit('admin_join', {
                        admin_id: currentAdmin.id,
                        nickname: currentAdmin.nickname
                    });
                });
                
                socket.on('new_order', function(data) {
                    console.log('–ù–æ–≤—ã–π –∑–∞–∫–∞–∑:', data);
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                    if (shouldShowNotification('newOrders')) {
                        showNotification('–ù–æ–≤—ã–π –∑–∞–∫–∞–∑', `–ü–æ—Å—Ç—É–ø–∏–ª –Ω–æ–≤—ã–π –∑–∞–∫–∞–∑ #${data.order_id.substring(0, 8)}`, 'info');
                        
                        // –ü—Ä–æ–∏–≥—Ä—ã–≤–∞–µ–º –∑–≤—É–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
                        playNotificationSound();
                    }
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫
                    updateOrdersBadge();
                    
                    // –ï—Å–ª–∏ –º—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∑–∞–∫–∞–∑–æ–≤, –æ–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫
                    if (document.getElementById('ordersSection').style.display !== 'none') {
                        loadOrders();
                    }
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                    if (document.getElementById('dashboardSection').style.display !== 'none') {
                        loadDashboardStats();
                    }
                });
                
                socket.on('order_updated', function(data) {
                    console.log('–ó–∞–∫–∞–∑ –æ–±–Ω–æ–≤–ª–µ–Ω:', data);
                    
                    // –ï—Å–ª–∏ —ç—Ç–æ —Ç–µ–∫—É—â–∏–π –∑–∞–∫–∞–∑, –æ–±–Ω–æ–≤–ª—è–µ–º –µ–≥–æ
                    if (currentOrder && currentOrder.order_id === data.order_id) {
                        loadOrderDetails(currentOrder.order_id);
                    }
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
                    if (document.getElementById('ordersSection').style.display !== 'none') {
                        loadOrders();
                    }
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                    if (document.getElementById('dashboardSection').style.display !== 'none') {
                        loadDashboardStats();
                    }
                });
                
socket.on('new_message', function(data) {
    console.log('–ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:', data);
    
    // –ï—Å–ª–∏ —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —Ç–µ–∫—É—â–µ–º –∑–∞–∫–∞–∑–µ, –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –≤ —á–∞—Ç
    if (currentOrder && currentOrder.order_id === data.order_id) {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –±—ã–ª–æ –ª–∏ —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ
        const messagesContainer = document.getElementById('detailChatMessages');
        const existingMessages = messagesContainer.querySelectorAll('.chat-message');
        const lastMessage = existingMessages[existingMessages.length - 1];
        
        let isDuplicate = false;
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è –ª–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
        if (lastMessage) {
            const lastMessageText = lastMessage.querySelector('.message-content')?.textContent || '';
            const newMessageText = data.message.message_text || '';
            
            // –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç (–º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º timestamp –∏–ª–∏ ID)
            if (lastMessageText === newMessageText && 
                Math.abs(new Date() - new Date(data.message.created_at)) < 5000) { // 5 —Å–µ–∫—É–Ω–¥
                isDuplicate = true;
            }
        }
        
        if (!isDuplicate) {
            addMessageToChat(data.message);
        }
    }
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
    if (shouldShowNotification('newMessages')) {
        showNotification('–ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ', `–ù–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –∑–∞–∫–∞–∑–µ #${data.order_id.substring(0, 8)}`, 'info');
    }
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã—Ö
    updateOrdersBadge();
});
                
                socket.on('verification_data_submitted', function(data) {
                    console.log('–î–∞–Ω–Ω—ã–µ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã:', data);
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                    if (shouldShowNotification('verificationData')) {
                        showNotification('–î–∞–Ω–Ω—ã–µ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏', `–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–∏–ª –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ –∑–∞–∫–∞–∑–µ #${data.order_id.substring(0, 8)}`, 'warning');
                    }
                    
                    // –ï—Å–ª–∏ —ç—Ç–æ —Ç–µ–∫—É—â–∏–π –∑–∞–∫–∞–∑, –æ–±–Ω–æ–≤–ª—è–µ–º –≤–∫–ª–∞–¥–∫—É –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
                    if (currentOrder && currentOrder.order_id === data.order_id) {
                        loadVerificationData(currentOrder.order_id);
                    }
                });
                
                socket.on('admin_online', function(data) {
                    console.log('–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –æ–Ω–ª–∞–π–Ω:', data);
                    updateOnlineAdmins();
                });
                
                socket.on('admin_offline', function(data) {
                    console.log('–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –æ—Ñ–ª–∞–π–Ω:', data);
                    updateOnlineAdmins();
                });
                
                socket.on('disconnect', function() {
                    console.log('WebSocket –æ—Ç–∫–ª—é—á–µ–Ω');
                    showNotification('–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä—è–Ω–æ', '–ü—ã—Ç–∞–µ–º—Å—è –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è...', 'warning');
                });
                
                socket.on('connect_error', function(error) {
                    console.error('–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è WebSocket:', error);
                });
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ WebSocket:', error);
            }
        }
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
        function setupEventListeners() {
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ–∏—Å–∫–∞
            document.getElementById('searchInput').addEventListener('input', debounce(function() {
                const searchTerm = this.value.trim();
                if (searchTerm) {
                    filters.search = searchTerm;
                } else {
                    delete filters.search;
                }
                currentPage = 1;
                loadOrders();
            }, 500));
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –≤–Ω–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
            document.addEventListener('click', function(event) {
                const modal = document.getElementById('orderDetailModal');
                if (event.target === modal) {
                    closeOrderDetail();
                }
            });
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∞–≤–∏—à–∏ Escape
            document.addEventListener('keydown', function(event) {
                if (event.key === 'Escape') {
                    closeOrderDetail();
                }
            });
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–∫–∞–∑–æ–≤
async function loadOrders() {
    try {
        console.log('=== LOADING ORDERS ===');
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
        document.getElementById('ordersLoading').style.display = 'flex';
        document.getElementById('noOrdersMessage').style.display = 'none';
        document.getElementById('ordersGrid').innerHTML = '';
        document.getElementById('pagination').style.display = 'none';
        
        // –§–æ—Ä–º–∏—Ä—É–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞
        const params = new URLSearchParams({
            ...filters,
            limit: limit,
            offset: (currentPage - 1) * limit
        });
        
        console.log('Request params:', params.toString());
        console.log('Admin credentials:', {
            id: currentAdmin.id,
            token: currentAdmin.token ? 'exists' : 'missing'
        });
        
        const url = `${API_BASE_URL}/admin/orders?${params}`;
        console.log('Request URL:', url);
        
        const response = await fetch(url, {
            headers: {
                'X-Admin-ID': currentAdmin.id,
                'X-Admin-Token': currentAdmin.token,
                'ngrok-skip-browser-warning': 'true'
            }
        });
        
        console.log('Response status:', response.status);
        
        const text = await response.text();
        console.log('Response text:', text.substring(0, 200));
        
        let data;
        try {
            data = JSON.parse(text);
            console.log('Parsed data:', data);
        } catch (e) {
            console.error('JSON parse error:', e);
            throw new Error('Invalid JSON from API');
        }
        
        if (data.success) {
            orders = data.orders;
            totalPages = Math.ceil(data.total / limit);
            
            console.log('Orders loaded:', orders.length);
            
            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∑–∞–∫–∞–∑—ã
            displayOrders(orders);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø–∞–≥–∏–Ω–∞—Ü–∏—é
            updatePagination();
            
            // –°–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            document.getElementById('ordersLoading').style.display = 'none';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ "–ù–µ—Ç –∑–∞–∫–∞–∑–æ–≤"
            if (orders.length === 0) {
                document.getElementById('noOrdersMessage').style.display = 'block';
            } else {
                document.getElementById('pagination').style.display = 'flex';
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
            updateOrdersBadge();
        } else {
            console.error('API returned error:', data.error);
            throw new Error(data.error || '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–∫–∞–∑–æ–≤');
        }
    } catch (error) {
        console.error('Load orders error:', error);
        document.getElementById('ordersLoading').style.display = 'none';
        document.getElementById('noOrdersMessage').style.display = 'block';
        showNotification('–û—à–∏–±–∫–∞', error.message || '–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∑–∞–∫–∞–∑—ã', 'error');
    }
}
        
        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤
        function displayOrders(orders) {
            const grid = document.getElementById('ordersGrid');
            grid.innerHTML = '';
            
            orders.forEach(order => {
                const card = createOrderCard(order);
                grid.appendChild(card);
            });
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –∑–∞–∫–∞–∑–∞
        function createOrderCard(order) {
            const card = document.createElement('div');
            card.className = 'order-card';
            card.dataset.orderId = order.order_id;
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ç–µ–∫—Å—Ç —Å—Ç–∞—Ç—É—Å–∞
            const statusText = getStatusText(order.status);
            const statusClass = `status-${order.status}`;
            
            // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –¥–∞—Ç—É
            const createdAt = new Date(order.created_at);
            const formattedDate = createdAt.toLocaleDateString('ru-RU', {
                day: '2-digit',
                month: '2-digit',
                year: '2-digit',
                hour: '2-digit',
                minute: '2-digit'
            });
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –±–µ–π–¥–∂–∏
            const badges = [];
            
            if (order.taken_by_id) {
                badges.push(`
                    <div class="order-badge badge-taken">
                        <i class="fas fa-user"></i>
                        ${order.taken_by_nickname}
                    </div>
                `);
            }
            
            if (order.unread_messages > 0) {
                badges.push(`
                    <div class="order-badge badge-unread">
                        <i class="fas fa-comment"></i>
                        ${order.unread_messages}
                    </div>
                `);
            }
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
            let actions = '';
            
            if (!order.taken_by_id) {
                actions += `
                    <button class="btn btn-primary btn-sm" onclick="takeOrder('${order.order_id}', event)">
                        <i class="fas fa-hand-paper"></i> –í–∑—è—Ç—å
                    </button>
                `;
            }
            
            if (order.status === 'pending') {
                actions += `
                    <button class="btn btn-success btn-sm" onclick="confirmOrderPayment('${order.order_id}', event)">
                        <i class="fas fa-check-circle"></i> –û–ø–ª–∞—Ç–∞
                    </button>
                `;
            }
            
            card.innerHTML = `
                <div class="order-header">
                    <div class="order-id">#${order.order_id.substring(0, 8)}</div>
                    <div class="order-status ${statusClass}">${statusText}</div>
                </div>
                
                <div class="order-info">
                    <div class="order-info-item">
                        <span class="order-info-label">–ë–∏—Ä–∂–∞:</span>
                        <span class="order-info-value">${order.exchange}</span>
                    </div>
                    <div class="order-info-item">
                        <span class="order-info-label">–ö–ª–∏–µ–Ω—Ç:</span>
                        <span class="order-info-value">${order.username || order.first_name || `ID ${order.user_id}`}</span>
                    </div>
                    <div class="order-info-item">
                        <span class="order-info-label">–£—Å–ª—É–≥–∞:</span>
                        <span class="order-info-value">${order.service}</span>
                    </div>
                    <div class="order-info-item">
                        <span class="order-info-label">–°—É–º–º–∞:</span>
                        <span class="order-info-value">$${order.amount}</span>
                    </div>
                    <div class="order-info-item">
                        <span class="order-info-label">–°–æ–∑–¥–∞–Ω:</span>
                        <span class="order-info-value">${formattedDate}</span>
                    </div>
                </div>
                
                <div class="order-footer">
                    <div class="order-badges">
                        ${badges.join('')}
                    </div>
                    <div class="order-actions">
                        ${actions}
                        <button class="btn btn-sm" onclick="showOrderDetail('${order.order_id}', event)">
                            <i class="fas fa-eye"></i> –ü–æ–¥—Ä–æ–±–Ω–µ–µ
                        </button>
                    </div>
                </div>
            `;
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É
            card.addEventListener('click', function(e) {
                if (!e.target.closest('button')) {
                    showOrderDetail(order.order_id);
                }
            });
            
            return card;
        }
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —Å—Ç–∞—Ç—É—Å–∞
        function getStatusText(status) {
            const statusMap = {
                'pending': '‚è≥ –û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã',
                'paid': 'üí≥ –û–ø–ª–∞—á–µ–Ω',
                'waiting_verification': 'üìù –ñ–¥–µ—Ç –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏',
                'verification_submitted': 'üì§ –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã',
                'in_progress': 'üîÑ –í —Ä–∞–±–æ—Ç–µ',
                'completed': '‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω',
                'cancelled': '‚ùå –û—Ç–º–µ–Ω–µ–Ω'
            };
            
            return statusMap[status] || status;
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞
        async function showOrderDetail(orderId, event) {
            if (event) {
                event.stopPropagation();
            }
            
            try {
                const response = await fetch(`${API_BASE_URL}/admin/orders/${orderId}`, {
                    headers: {
                        'X-Admin-ID': currentAdmin.id,
                        'X-Admin-Token': currentAdmin.token,
                        'ngrok-skip-browser-warning': 'true'
                    }
                });
                
                if (!response.ok) {
                    throw new Error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–µ—Ç–∞–ª–µ–π –∑–∞–∫–∞–∑–∞');
                }
                
                const data = await response.json();
                
                if (data.success) {
                    currentOrder = data.order;
                    displayOrderDetail(currentOrder);
                    document.getElementById('orderDetailModal').style.display = 'block';
                    document.body.style.overflow = 'hidden';
                    
                    // –ó–∞–≥—Ä—É–∂–∞–µ–º —á–∞—Ç
                    loadChatMessages(orderId);
                    
                    // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é
                    loadOrderHistory(orderId);
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –≤–∫–ª–∞–¥–∫—É –¥–µ–π—Å—Ç–≤–∏–π
                    updateOrderActions();
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–µ—Ç–∞–ª–µ–π –∑–∞–∫–∞–∑–∞:', error);
                showNotification('–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞', 'error');
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–µ—Ç–∞–ª–µ–π –∑–∞–∫–∞–∑–∞
        async function loadOrderDetails(orderId) {
            try {
                const response = await fetch(`${API_BASE_URL}/admin/orders/${orderId}`, {
                    headers: {
                        'X-Admin-ID': currentAdmin.id,
                        'X-Admin-Token': currentAdmin.token,
                        'ngrok-skip-browser-warning': 'true'
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.success && currentOrder && currentOrder.order_id === orderId) {
                        currentOrder = data.order;
                        displayOrderDetail(currentOrder);
                    }
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–µ—Ç–∞–ª–µ–π –∑–∞–∫–∞–∑–∞:', error);
            }
        }
        
        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–µ—Ç–∞–ª–µ–π –∑–∞–∫–∞–∑–∞
        function displayOrderDetail(order) {
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
            document.getElementById('detailOrderId').textContent = `#${order.order_id.substring(0, 8)}`;
            document.getElementById('detailFullOrderId').textContent = order.order_id;
            
            // –°—Ç–∞—Ç—É—Å
            const statusElement = document.getElementById('detailStatus');
            statusElement.textContent = getStatusText(order.status);
            statusElement.className = 'detail-value';
            statusElement.classList.add(`status-${order.status}`);
            
            // –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
            document.getElementById('detailExchange').textContent = order.exchange;
            document.getElementById('detailService').textContent = order.service;
            document.getElementById('detailQuantity').textContent = order.quantity;
            document.getElementById('detailCountry').textContent = order.country || '–ù–µ —É–∫–∞–∑–∞–Ω–∞';
            
            // –§–∏–Ω–∞–Ω—Å—ã
            document.getElementById('detailAmount').textContent = `$${order.amount}`;
            document.getElementById('detailCrypto').textContent = order.crypto ? order.crypto.toUpperCase() : '–ù–µ —É–∫–∞–∑–∞–Ω–∞';
            document.getElementById('detailNetwork').textContent = order.network || '–ù–µ —É–∫–∞–∑–∞–Ω–∞';
            document.getElementById('detailWallet').textContent = order.wallet_address || '–ù–µ —É–∫–∞–∑–∞–Ω';
            
            // –ö–ª–∏–µ–Ω—Ç
            document.getElementById('detailUserId').textContent = order.user_id;
            document.getElementById('detailUserName').textContent = order.first_name || order.username || '–ù–µ —É–∫–∞–∑–∞–Ω–æ';
            document.getElementById('detailUserTelegram').textContent = order.username ? `@${order.username}` : '–ù–µ —É–∫–∞–∑–∞–Ω';
            
            // –î–∞—Ç—ã
            const createdAt = new Date(order.created_at);
            document.getElementById('detailCreatedAt').textContent = createdAt.toLocaleString('ru-RU');
            document.getElementById('detailLastUpdate').textContent = new Date().toLocaleTimeString('ru-RU');
        }
        
        // –ó–∞–∫—Ä—ã—Ç—å –¥–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞
        function closeOrderDetail() {
            document.getElementById('orderDetailModal').style.display = 'none';
            document.body.style.overflow = 'auto';
            currentOrder = null;
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å –≤–∫–ª–∞–¥–∫—É –≤ –¥–µ—Ç–∞–ª—è—Ö –∑–∞–∫–∞–∑–∞
        function showDetailTab(tabId) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–æ –≤—Å–µ—Ö —Ç–∞–±–æ–≤
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
            document.getElementById(`${tabId}TabContent`).classList.add('active');
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ç–∞–±
            document.querySelector(`.tab[data-tab="${tabId}"]`).classList.add('active');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
            if (tabId === 'verification' && currentOrder) {
                loadVerificationData(currentOrder.order_id);
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π —á–∞—Ç–∞
        async function loadChatMessages(orderId) {
            try {
                const response = await fetch(`${API_BASE_URL}/admin/orders/${orderId}/chat`, {
                    headers: {
                        'X-Admin-ID': currentAdmin.id,
                        'X-Admin-Token': currentAdmin.token,
                        'ngrok-skip-browser-warning': 'true'
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.success) {
                        displayChatMessages(data.messages);
                    }
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —á–∞—Ç–∞:', error);
            }
        }
        
        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π —á–∞—Ç–∞
        function displayChatMessages(messages) {
            const container = document.getElementById('detailChatMessages');
            container.innerHTML = '';
            
            if (!messages || messages.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px 20px; opacity: 0.7;">
                        <i class="fas fa-comments" style="font-size: 48px; margin-bottom: 20px;"></i>
                        <div>–ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π</div>
                        <div style="font-size: 12px; margin-top: 10px;">–ù–∞—á–Ω–∏—Ç–µ –æ–±—â–µ–Ω–∏–µ —Å –∫–ª–∏–µ–Ω—Ç–æ–º</div>
                    </div>
                `;
                return;
            }
            
            messages.forEach(message => {
                const messageElement = createMessageElement(message);
                container.appendChild(messageElement);
            });
            
            // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –≤–Ω–∏–∑
            container.scrollTop = container.scrollHeight;
        }
        
        // –î–æ–±–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —á–∞—Ç
        function addMessageToChat(message) {
            const container = document.getElementById('detailChatMessages');
            const messageElement = createMessageElement(message);
            container.appendChild(messageElement);
            
            // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –≤–Ω–∏–∑
            container.scrollTop = container.scrollHeight;
        }
        
        // –°–æ–∑–¥–∞–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
        function createMessageElement(message) {
            const div = document.createElement('div');
            div.className = `chat-message message-${message.sender_type}`;
            
            const time = new Date(message.created_at).toLocaleTimeString('ru-RU', {
                hour: '2-digit',
                minute: '2-digit'
            });
            
            let content = message.message_text || '';
            if (message.file_url) {
                content += `<div class="message-file">
                    <i class="fas fa-paperclip"></i>
                    <a href="${message.file_url}" target="_blank" style="color: var(--primary-color);">–ü—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª</a>
                </div>`;
            }
            
            div.innerHTML = `
                <div class="message-header">
                    <div class="message-sender">${message.sender_name || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</div>
                    <div class="message-time">${time}</div>
                </div>
                <div class="message-content">${content}</div>
            `;
            
            return div;
        }
        
        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
// –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
// –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è - –≤–∞—Ä–∏–∞–Ω—Ç 2 (–ø—Ä–æ—â–µ)
async function sendChatMessage() {
    if (!currentOrder) return;
    
    const input = document.getElementById('detailChatInput');
    const message = input.value.trim();
    
    if (!message) return;
    
    input.value = '';
    
    try {
        const response = await fetch(`${API_BASE_URL}/admin/orders/${currentOrder.order_id}/message`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-Admin-ID': currentAdmin.id,
                'X-Admin-Token': currentAdmin.token,
                'ngrok-skip-browser-warning': 'true'
            },
            body: JSON.stringify({
                admin_id: parseInt(currentAdmin.id),
                message: message
            })
        });
        
        if (response.ok) {
            const data = await response.json();
            if (data.success) {
                // –°–æ–æ–±—â–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–æ —á–µ—Ä–µ–∑ WebSocket event
                // –ù–µ –¥–æ–±–∞–≤–ª—è–µ–º –µ–≥–æ –ª–æ–∫–∞–ª—å–Ω–æ
            }
        } else {
            const error = await response.json();
            showNotification('–û—à–∏–±–∫–∞', error.error || '–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ', 'error');
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—Å—Ç –µ—Å–ª–∏ –æ—à–∏–±–∫–∞
            input.value = message;
        }
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è:', error);
        showNotification('–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ', 'error');
        input.value = message;
    }
}
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à–∏ –≤ —á–∞—Ç–µ
        function handleChatInputKeydown(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendChatMessage();
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
        async function loadVerificationData(orderId) {
            try {
                const response = await fetch(`${API_BASE_URL}/admin/orders/${orderId}/verification-data`, {
                    headers: {
                        'X-Admin-ID': currentAdmin.id,
                        'X-Admin-Token': currentAdmin.token,
                        'ngrok-skip-browser-warning': 'true'
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    displayVerificationData(data.data);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏:', error);
            }
        }
        
        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
function displayVerificationData(data) {
    const container = document.getElementById('verificationDataContent');
    
    if (!data || data.length === 0) {
        container.innerHTML = `
            <div style="text-align: center; padding: 40px 20px; opacity: 0.7;">
                <i class="fas fa-inbox" style="font-size: 48px; margin-bottom: 20px;"></i>
                <div>–î–∞–Ω–Ω—ã–µ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã</div>
                <div style="font-size: 12px; margin-top: 10px;">–ö–ª–∏–µ–Ω—Ç –µ—â–µ –Ω–µ –æ—Ç–ø—Ä–∞–≤–∏–ª –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏</div>
            </div>
        `;
        return;
    }
    
    let html = '<div style="display: flex; flex-direction: column; gap: 15px;">';
    
    data.forEach(item => {
        const time = new Date(item.submitted_at).toLocaleString('ru-RU');
        
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ–ª—è
        const fieldNames = {
            'verification_file': 'üìÑ –§–∞–π–ª',
            'verification_data': 'üìù –¢–µ–∫—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ',
            'file_description': 'üìã –û–ø–∏—Å–∞–Ω–∏–µ —Ñ–∞–π–ª–∞',
            'verification_photo': 'üì∑ –§–æ—Ç–æ',
            'login': 'üë§ –õ–æ–≥–∏–Ω/Email',
            'password': 'üîë –ü–∞—Ä–æ–ª—å',
            'account_info': 'üè¶ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–∫–∫–∞—É–Ω—Ç–µ',
            'additional_info': 'üìé –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è'
        };
        
        const fieldName = fieldNames[item.field_name] || item.field_name;
        
        html += `
            <div style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 8px;">
                <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px;">
                    <div style="font-size: 14px; font-weight: 600; color: var(--primary-color);">
                        ${fieldName}
                    </div>
                    <div style="font-size: 11px; opacity: 0.6;">
                        <i class="far fa-clock"></i> ${time}
                    </div>
                </div>
                
                <div style="font-size: 14px; margin-bottom: 10px; word-break: break-all; white-space: pre-wrap; line-height: 1.5; background: rgba(255,255,255,0.05); padding: 10px; border-radius: 6px;">
                    ${item.field_value || '<span style="opacity: 0.5;">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</span>'}
                </div>
        `;
        
        if (item.file_url) {
            // –ò–∑–≤–ª–µ–∫–∞–µ–º –∏–º—è —Ñ–∞–π–ª–∞ –∏–∑ URL –∏–ª–∏ field_value
            let fileName = '–°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª';
            if (item.field_value && item.field_value.includes('–§–∞–π–ª:')) {
                fileName = item.field_value.replace('–§–∞–π–ª:', '').trim();
            }
            
            html += `
                <div style="margin-top: 10px;">
                    <a href="${item.file_url}" 
                       target="_blank" 
                       style="color: var(--primary-color); text-decoration: none; display: inline-flex; align-items: center; gap: 5px; padding: 6px 12px; background: rgba(102, 126, 234, 0.1); border-radius: 6px;">
                        <i class="fas fa-download"></i>
                        <span>${fileName}</span>
                    </a>
                </div>
            `;
        }
        
        html += `</div>`;
    });
    
    html += '</div>';
    container.innerHTML = html;
}
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–∫–∞–∑–∞
        async function loadOrderHistory(orderId) {
            try {
                const response = await fetch(`${API_BASE_URL}/admin/orders/${orderId}/history`, {
                    headers: {
                        'X-Admin-ID': currentAdmin.id,
                        'X-Admin-Token': currentAdmin.token,
                        'ngrok-skip-browser-warning': 'true'
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    displayOrderHistory(data.history);
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏—Å—Ç–æ—Ä–∏–∏:', error);
            }
        }
        
        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–∫–∞–∑–∞
        function displayOrderHistory(history) {
            const tbody = document.getElementById('detailHistoryTable');
            tbody.innerHTML = '';
            
            if (!history || history.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="4" style="text-align: center; padding: 40px; opacity: 0.7;">
                            <i class="fas fa-history" style="font-size: 24px; margin-bottom: 10px; display: block;"></i>
                            <div>–ò—Å—Ç–æ—Ä–∏—è –¥–µ–π—Å—Ç–≤–∏–π –ø—É—Å—Ç–∞</div>
                        </td>
                    </tr>
                `;
                return;
            }
            
            history.forEach(record => {
                const time = new Date(record.created_at).toLocaleString('ru-RU');
                const actionText = getActionText(record.action);
                
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${time}</td>
                    <td>${actionText}</td>
                    <td>${record.nickname || `–ê–¥–º–∏–Ω #${record.admin_id}`}</td>
                    <td>${record.details || '‚Äî'}</td>
                `;
                tbody.appendChild(row);
            });
        }
        
        // –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –¥–µ–π—Å—Ç–≤–∏—è
        function getActionText(action) {
            const actions = {
                'taken': '–í–∑—è–ª –∑–∞–∫–∞–∑',
                'payment_confirmed': '–ü–æ–¥—Ç–≤–µ—Ä–¥–∏–ª –æ–ø–ª–∞—Ç—É',
                'message_sent': '–û—Ç–ø—Ä–∞–≤–∏–ª —Å–æ–æ–±—â–µ–Ω–∏–µ',
                'verification_started': '–ù–∞—á–∞–ª –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é',
                'verification_submitted': '–ü–æ–ª—É—á–∏–ª –¥–∞–Ω–Ω—ã–µ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏',
                'completed': '–ó–∞–≤–µ—Ä—à–∏–ª –∑–∞–∫–∞–∑',
                'cancelled': '–û—Ç–º–µ–Ω–∏–ª –∑–∞–∫–∞–∑',
                'status_updated': '–û–±–Ω–æ–≤–∏–ª —Å—Ç–∞—Ç—É—Å'
            };
            
            return actions[action] || action;
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –¥–ª—è –∑–∞–∫–∞–∑–∞
        function updateOrderActions() {
            if (!currentOrder) return;
            
            // –ö–Ω–æ–ø–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ–ø–ª–∞—Ç—ã
            const confirmPaymentBtn = document.getElementById('confirmPaymentBtn');
            confirmPaymentBtn.disabled = currentOrder.status !== 'pending';
            
            // –ö–Ω–æ–ø–∫–∞ –≤–∑—è—Ç–∏—è –∑–∞–∫–∞–∑–∞
            const takeOrderBtn = document.getElementById('takeOrderBtn');
            if (currentOrder.taken_by_id) {
                takeOrderBtn.disabled = true;
                takeOrderBtn.innerHTML = '<i class="fas fa-user-check"></i> –£–∂–µ –≤–∑—è—Ç';
            } else {
                takeOrderBtn.disabled = false;
                takeOrderBtn.innerHTML = '<i class="fas fa-hand-paper"></i> –í–∑—è—Ç—å –∑–∞–∫–∞–∑';
            }
            
            // –ö–Ω–æ–ø–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞
            const completeOrderBtn = document.getElementById('completeOrderBtn');
            const canComplete = ['in_progress', 'waiting_verification', 'verification_submitted'].includes(currentOrder.status);
            completeOrderBtn.disabled = !canComplete;
        }
        
        // –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–ø–ª–∞—Ç—ã
        async function confirmPayment() {
            if (!currentOrder) return;
            
            if (confirm('–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ–ø–ª–∞—Ç—É –∑–∞–∫–∞–∑–∞?')) {
                try {
                    const response = await fetch(`${API_BASE_URL}/admin/orders/${currentOrder.order_id}/confirm-payment`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-Admin-ID': currentAdmin.id,
                            'X-Admin-Token': currentAdmin.token,
                            'ngrok-skip-browser-warning': 'true'
                        },
                        body: JSON.stringify({
                            admin_id: parseInt(currentAdmin.id)
                        })
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        if (data.success) {
                            showNotification('–£—Å–ø–µ—à–Ω–æ', '–û–ø–ª–∞—Ç–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞', 'success');
                            loadOrderDetails(currentOrder.order_id);
                        }
                    } else {
                        const error = await response.json();
                        showNotification('–û—à–∏–±–∫–∞', error.error || '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ–ø–ª–∞—Ç—É', 'error');
                    }
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ–ø–ª–∞—Ç—ã:', error);
                    showNotification('–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ–ø–ª–∞—Ç—É', 'error');
                }
            }
        }
        
        // –í–∑—è—Ç—å –∑–∞–∫–∞–∑
        async function takeOrderAction() {
            if (!currentOrder) return;
            
            try {
                const response = await fetch(`${API_BASE_URL}/admin/orders/${currentOrder.order_id}/take`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Admin-ID': currentAdmin.id,
                        'X-Admin-Token': currentAdmin.token,
                        'ngrok-skip-browser-warning': 'true'
                    },
                    body: JSON.stringify({
                        admin_id: parseInt(currentAdmin.id)
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.success) {
                        showNotification('–£—Å–ø–µ—à–Ω–æ', '–ó–∞–∫–∞–∑ –≤–∑—è—Ç –≤ —Ä–∞–±–æ—Ç—É', 'success');
                        loadOrderDetails(currentOrder.order_id);
                    }
                } else {
                    const error = await response.json();
                    showNotification('–û—à–∏–±–∫–∞', error.error || '–ù–µ —É–¥–∞–ª–æ—Å—å –≤–∑—è—Ç—å –∑–∞–∫–∞–∑', 'error');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≤–∑—è—Ç–∏—è –∑–∞–∫–∞–∑–∞:', error);
                showNotification('–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å –≤–∑—è—Ç—å –∑–∞–∫–∞–∑', 'error');
            }
        }
        
        // –ó–∞–≤–µ—Ä—à–∏—Ç—å –∑–∞–∫–∞–∑
        async function completeOrderAction() {
            if (!currentOrder) return;
            
            if (confirm('–ó–∞–≤–µ—Ä—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –∑–∞–∫–∞–∑–∞?')) {
                try {
                    const response = await fetch(`${API_BASE_URL}/admin/orders/${currentOrder.order_id}/complete`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-Admin-ID': currentAdmin.id,
                            'X-Admin-Token': currentAdmin.token,
                            'ngrok-skip-browser-warning': 'true'
                        },
                        body: JSON.stringify({
                            admin_id: parseInt(currentAdmin.id)
                        })
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        if (data.success) {
                            showNotification('–£—Å–ø–µ—à–Ω–æ', '–ó–∞–∫–∞–∑ –∑–∞–≤–µ—Ä—à–µ–Ω', 'success');
                            loadOrderDetails(currentOrder.order_id);
                        }
                    } else {
                        const error = await response.json();
                        showNotification('–û—à–∏–±–∫–∞', error.error || '–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≤–µ—Ä—à–∏—Ç—å –∑–∞–∫–∞–∑', 'error');
                    }
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞:', error);
                    showNotification('–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≤–µ—Ä—à–∏—Ç—å –∑–∞–∫–∞–∑', 'error');
                }
            }
        }
        
        // –û—Ç–º–µ–Ω–∏—Ç—å –∑–∞–∫–∞–∑
        async function cancelOrderAction() {
            if (!currentOrder) return;
            
            const reason = prompt('–£–∫–∞–∂–∏—Ç–µ –ø—Ä–∏—á–∏–Ω—É –æ—Ç–º–µ–Ω—ã –∑–∞–∫–∞–∑–∞:');
            if (reason === null) return;
            
            try {
                const response = await fetch(`${API_BASE_URL}/admin/orders/${currentOrder.order_id}/cancel`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Admin-ID': currentAdmin.id,
                        'X-Admin-Token': currentAdmin.token,
                        'ngrok-skip-browser-warning': 'true'
                    },
                    body: JSON.stringify({
                        admin_id: parseInt(currentAdmin.id),
                        reason: reason
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.success) {
                        showNotification('–£—Å–ø–µ—à–Ω–æ', '–ó–∞–∫–∞–∑ –æ—Ç–º–µ–Ω–µ–Ω', 'success');
                        closeOrderDetail();
                        loadOrders();
                    }
                } else {
                    const error = await response.json();
                    showNotification('–û—à–∏–±–∫–∞', error.error || '–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–º–µ–Ω–∏—Ç—å –∑–∞–∫–∞–∑', 'error');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ—Ç–º–µ–Ω—ã –∑–∞–∫–∞–∑–∞:', error);
                showNotification('–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–º–µ–Ω–∏—Ç—å –∑–∞–∫–∞–∑', 'error');
            }
        }
        
        // –í–∑—è—Ç—å –∑–∞–∫–∞–∑ –∏–∑ —Å–ø–∏—Å–∫–∞
        async function takeOrder(orderId, event) {
            event.stopPropagation();
            
            try {
                const response = await fetch(`${API_BASE_URL}/admin/orders/${orderId}/take`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Admin-ID': currentAdmin.id,
                        'X-Admin-Token': currentAdmin.token,
                        'ngrok-skip-browser-warning': 'true'
                    },
                    body: JSON.stringify({
                        admin_id: parseInt(currentAdmin.id)
                    })
                });
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.success) {
                        showNotification('–£—Å–ø–µ—à–Ω–æ', '–ó–∞–∫–∞–∑ –≤–∑—è—Ç –≤ —Ä–∞–±–æ—Ç—É', 'success');
                        loadOrders();
                    }
                } else {
                    const error = await response.json();
                    showNotification('–û—à–∏–±–∫–∞', error.error || '–ù–µ —É–¥–∞–ª–æ—Å—å –≤–∑—è—Ç—å –∑–∞–∫–∞–∑', 'error');
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≤–∑—è—Ç–∏—è –∑–∞–∫–∞–∑–∞:', error);
                showNotification('–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å –≤–∑—è—Ç—å –∑–∞–∫–∞–∑', 'error');
            }
        }
        
        // –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ–ø–ª–∞—Ç—É –∏–∑ —Å–ø–∏—Å–∫–∞
        async function confirmOrderPayment(orderId, event) {
            event.stopPropagation();
            
            if (confirm('–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ–ø–ª–∞—Ç—É –∑–∞–∫–∞–∑–∞?')) {
                try {
                    const response = await fetch(`${API_BASE_URL}/admin/orders/${orderId}/confirm-payment`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-Admin-ID': currentAdmin.id,
                            'X-Admin-Token': currentAdmin.token,
                            'ngrok-skip-browser-warning': 'true'
                        },
                        body: JSON.stringify({
                            admin_id: parseInt(currentAdmin.id)
                        })
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        if (data.success) {
                            showNotification('–£—Å–ø–µ—à–Ω–æ', '–û–ø–ª–∞—Ç–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞', 'success');
                            loadOrders();
                        }
                    } else {
                        const error = await response.json();
                        showNotification('–û—à–∏–±–∫–∞', error.error || '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ–ø–ª–∞—Ç—É', 'error');
                    }
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ–ø–ª–∞—Ç—ã:', error);
                    showNotification('–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ–ø–ª–∞—Ç—É', 'error');
                }
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –¥–∞—à–±–æ—Ä–¥–∞
async function loadDashboardStats() {
    try {
        console.log('–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –¥–∞—à–±–æ—Ä–¥–∞...');
        
        const response = await fetch(`${API_BASE_URL}/admin/dashboard-stats`, {
            headers: {
                'X-Admin-ID': currentAdmin.id,
                'X-Admin-Token': currentAdmin.token,
                'ngrok-skip-browser-warning': 'true'
            }
        });
        
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const data = await response.json();
        
        if (data.success) {
            displayDashboardStats(data.stats);
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
            await loadRecentActivities();
        } else {
            throw new Error(data.error || '–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É');
        }
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –¥–∞—à–±–æ—Ä–¥–∞:', error);
        document.getElementById('dashboardLoading').style.display = 'none';
        showNotification('–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–∞—à–±–æ—Ä–¥–∞', 'error');
    }
}
        
        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –¥–∞—à–±–æ—Ä–¥–∞
        function displayDashboardStats(stats) {
            const container = document.getElementById('dashboardStats');
            
            container.innerHTML = `
                <div class="stat-card">
                    <h3><i class="fas fa-users"></i> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h3>
                    <div class="stat-value-large">${stats.total_users}</div>
                    <div class="stat-trend">
                        <i class="fas fa-user-plus"></i>
                        <span>–í—Å–µ–≥–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ</span>
                    </div>
                </div>
                
                <div class="stat-card">
                    <h3><i class="fas fa-shopping-cart"></i> –ó–∞–∫–∞–∑—ã</h3>
                    <div class="stat-value-large">${stats.total_orders}</div>
                    <div class="stat-trend">
                        <i class="fas fa-chart-line"></i>
                        <span>–í—Å–µ–≥–æ —Å–æ–∑–¥–∞–Ω–æ</span>
                    </div>
                </div>
                
                <div class="stat-card">
                    <h3><i class="fas fa-money-bill-wave"></i> –í—ã—Ä—É—á–∫–∞</h3>
                    <div class="stat-value-large">$${stats.total_revenue}</div>
                    <div class="stat-trend">
                        <i class="fas fa-wallet"></i>
                        <span>–û–±—â–∞—è —Å—É–º–º–∞</span>
                    </div>
                </div>
                
                <div class="stat-card">
                    <h3><i class="fas fa-clock"></i> –í —Ä–∞–±–æ—Ç–µ</h3>
                    <div class="stat-value-large">${stats.in_progress_orders}</div>
                    <div class="stat-trend">
                        <i class="fas fa-cogs"></i>
                        <span>–ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–∫–∞–∑—ã</span>
                    </div>
                </div>
                
                <div class="stat-card">
                    <h3><i class="fas fa-hourglass-half"></i> –û–∂–∏–¥–∞—é—Ç</h3>
                    <div class="stat-value-large">${stats.pending_orders}</div>
                    <div class="stat-trend">
                        <i class="fas fa-clock"></i>
                        <span>–û–∂–∏–¥–∞—é—Ç –æ–ø–ª–∞—Ç—ã</span>
                    </div>
                </div>
                
                <div class="stat-card">
                    <h3><i class="fas fa-calendar-day"></i> –°–µ–≥–æ–¥–Ω—è</h3>
                    <div class="stat-value-large">${stats.completed_today}</div>
                    <div class="stat-trend">
                        <i class="fas fa-check-circle"></i>
                        <span>–ó–∞–≤–µ—Ä—à–µ–Ω–æ —Å–µ–≥–æ–¥–Ω—è</span>
                    </div>
                </div>
            `;
            
            // –°–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            document.getElementById('dashboardLoading').style.display = 'none';
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –æ–Ω–ª–∞–π–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
async function loadOnlineAdmins() {
    try {
        console.log('–ó–∞–≥—Ä—É–∑–∫–∞ –æ–Ω–ª–∞–π–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤...');
        
        const response = await fetch(`${API_BASE_URL}/admin/online`, {
            headers: {
                'X-Admin-ID': currentAdmin.id,
                'X-Admin-Token': currentAdmin.token,
                'ngrok-skip-browser-warning': 'true'
            }
        });
        
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const data = await response.json();
        
        if (data.success) {
            updateOnlineAdmins(data.online_admins);
        } else {
            throw new Error(data.error || '–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤');
        }
        
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –æ–Ω–ª–∞–π–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:', error);
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
        const container = document.getElementById('activeAdmins');
        container.innerHTML = `
            <div style="text-align: center; padding: 20px; opacity: 0.7;">
                <i class="fas fa-exclamation-triangle" style="font-size: 24px; margin-bottom: 10px; color: var(--warning-color);"></i>
                <div>–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤</div>
                <div style="font-size: 12px; margin-top: 5px;">${error.message || '–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ'}</div>
            </div>
        `;
    }
}
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –æ–Ω–ª–∞–π–Ω –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤
        function updateOnlineAdmins(admins) {
            const count = admins ? admins.length : 1;
            document.getElementById('onlineCount').textContent = count;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –≤ —Ä–∞–∑–¥–µ–ª–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
            if (document.getElementById('statisticsSection').style.display !== 'none') {
                const container = document.getElementById('activeAdmins');
                if (admins && admins.length > 0) {
                    let html = '<div style="display: flex; flex-direction: column; gap: 10px;">';
                    admins.forEach(admin => {
                        const minutesAgo = Math.floor(admin.seconds_ago / 60);
                        html += `
                            <div style="display: flex; align-items: center; gap: 10px; padding: 8px; background: rgba(255,255,255,0.05); border-radius: 6px;">
                                <div style="width: 8px; height: 8px; background: var(--success-color); border-radius: 50%;"></div>
                                <div style="flex: 1;">
                                    <div style="font-weight: 500;">${admin.nickname}</div>
                                    <div style="font-size: 11px; opacity: 0.6;">${admin.username}</div>
                                </div>
                                <div style="font-size: 11px; opacity: 0.6;">
                                    ${minutesAgo} –º–∏–Ω. –Ω–∞–∑–∞–¥
                                </div>
                            </div>
                        `;
                    });
                    html += '</div>';
                    container.innerHTML = html;
                } else {
                    container.innerHTML = '<div style="opacity: 0.7; text-align: center; padding: 20px;">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤</div>';
                }
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
async function loadAdminStats() {
    try {
        console.log('–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞...');
        
        const response = await fetch(`${API_BASE_URL}/admin/stats/${currentAdmin.id}`, {
            headers: {
                'X-Admin-ID': currentAdmin.id,
                'X-Admin-Token': currentAdmin.token,
                'ngrok-skip-browser-warning': 'true'
            }
        });
        
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const data = await response.json();
        
        if (data.success) {
            displayAdminStats(data.stats);
            // –°–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
            document.getElementById('statsLoading').style.display = 'none';
        } else {
            throw new Error(data.error || '–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É');
        }
        
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:', error);
        document.getElementById('statsLoading').style.display = 'none';
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
        const container = document.getElementById('myStats');
        container.innerHTML = `
            <div style="text-align: center; padding: 20px; opacity: 0.7;">
                <i class="fas fa-exclamation-triangle" style="font-size: 24px; margin-bottom: 10px; color: var(--warning-color);"></i>
                <div>–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</div>
                <div style="font-size: 12px; margin-top: 5px;">${error.message || '–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ'}</div>
            </div>
        `;
    }
}

// –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è displayAdminStats
function displayAdminStats(stats) {
    const container = document.getElementById('myStats');
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ
    if (!stats) {
        container.innerHTML = `
            <div style="text-align: center; padding: 20px; opacity: 0.7;">
                <i class="fas fa-info-circle" style="font-size: 24px; margin-bottom: 10px;"></i>
                <div>–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</div>
            </div>
        `;
        return;
    }
    
    container.innerHTML = `
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 20px; margin-bottom: 20px;">
            <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; text-align: center;">
                <div style="font-size: 11px; opacity: 0.7; margin-bottom: 5px;">–í–∑—è—Ç–æ –∑–∞–∫–∞–∑–æ–≤</div>
                <div style="font-size: 28px; font-weight: 700; color: var(--primary-color);">${stats.taken_orders || 0}</div>
            </div>
            
            <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; text-align: center;">
                <div style="font-size: 11px; opacity: 0.7; margin-bottom: 5px;">–ó–∞–≤–µ—Ä—à–µ–Ω–æ –∑–∞–∫–∞–∑–æ–≤</div>
                <div style="font-size: 28px; font-weight: 700; color: var(--success-color);">${stats.completed_orders || 0}</div>
            </div>
            
            <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; text-align: center;">
                <div style="font-size: 11px; opacity: 0.7; margin-bottom: 5px;">–°–æ–æ–±—â–µ–Ω–∏–π –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ</div>
                <div style="font-size: 28px; font-weight: 700; color: var(--info-color);">${stats.messages_sent || 0}</div>
            </div>
            
            <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; text-align: center;">
                <div style="font-size: 11px; opacity: 0.7; margin-bottom: 5px;">–û–±—â–∞—è —Å—É–º–º–∞</div>
                <div style="font-size: 28px; font-weight: 700; color: var(--secondary-color);">$${stats.total_amount || 0}</div>
            </div>
        </div>
        
        <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 8px; margin-top: 20px;">
            <div style="font-size: 13px; opacity: 0.7; margin-bottom: 10px;">–û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:</div>
            <div style="display: flex; justify-content: space-between; font-size: 12px;">
                <div>–°—Ä–µ–¥–Ω—è—è —Å—É–º–º–∞ –∑–∞–∫–∞–∑–∞: <span style="font-weight: 600; color: var(--primary-color);">$${stats.average_order || 0}</span></div>
                <div>–ö–æ–Ω–≤–µ—Ä—Å–∏—è: <span style="font-weight: 600; color: var(--success-color);">${stats.completion_rate || 0}%</span></div>
            </div>
        </div>
    `;
    
    // –°–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
    document.getElementById('statsLoading').style.display = 'none';
}
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Ä–∞–∑–¥–µ–ª
        // –ü–æ–∫–∞–∑–∞—Ç—å —Ä–∞–∑–¥–µ–ª
function showSection(sectionId) {
    console.log('Switching to section:', sectionId);
    
    // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Ä–∞–∑–¥–µ–ª—ã
    document.querySelectorAll('.section-content').forEach(section => {
        section.style.display = 'none';
    });
    
    // –°–∫—Ä—ã–≤–∞–µ–º —Ñ–∏–ª—å—Ç—Ä—ã –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    document.getElementById('filtersContainer').style.display = 'none';
    document.getElementById('statsBar').style.display = 'none';
    
    // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–æ –≤—Å–µ—Ö –ø—É–Ω–∫—Ç–æ–≤ –º–µ–Ω—é
    document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
    });
    
    // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø—É–Ω–∫—Ç –º–µ–Ω—é
    const navItem = document.querySelector(`.nav-item[data-section="${sectionId}"]`);
    if (navItem) {
        navItem.classList.add('active');
    }
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ä–∞–∑–¥–µ–ª
    const sectionElement = document.getElementById(`${sectionId}Section`);
    if (sectionElement) {
        sectionElement.style.display = 'block';
    } else {
        console.error(`Section ${sectionId}Section not found!`);
        return;
    }
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–∞–∑–¥–µ–ª–∞
    if (sectionId === 'orders') {
        document.getElementById('filtersContainer').style.display = 'block';
        loadAdminStatsBar();
    } else if (sectionId === 'dashboard') {
        // –°–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞—à–±–æ—Ä–¥–∞ –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å
        const dashboardLoading = document.getElementById('dashboardLoading');
        if (dashboardLoading) {
            dashboardLoading.style.display = 'none';
        }
        loadDashboardStats();
        loadRecentActivities();
    } else if (sectionId === 'statistics') {
        // –°–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –µ—Å–ª–∏ –æ–Ω –µ—Å—Ç—å
        const statsLoading = document.getElementById('statsLoading');
        if (statsLoading) {
            statsLoading.style.display = 'flex';
        }
        
        // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞–∑–¥–µ–ª–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        loadAdminStats();
        loadOnlineAdmins();
    }
    
    // –°–∫—Ä—ã–≤–∞–µ–º –º–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç–æ
    if (window.innerWidth <= 992) {
        document.getElementById('sidebar').classList.remove('show');
    }
}
            

            
            // –°–∫—Ä—ã–≤–∞–µ–º –º–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é –µ—Å–ª–∏ –æ—Ç–∫—Ä—ã—Ç–æ
            if (window.innerWidth <= 992) {
                document.getElementById('sidebar').classList.remove('show');
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –¥–ª—è –≤–µ—Ä—Ö–Ω–µ–π –ø–∞–Ω–µ–ª–∏
        async function loadAdminStatsBar() {
            try {
                const response = await fetch(`${API_BASE_URL}/admin/dashboard-stats`, {
                    headers: {
                        'X-Admin-ID': currentAdmin.id,
                        'X-Admin-Token': currentAdmin.token,
                        'ngrok-skip-browser-warning': 'true'
                    }
                });
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.success) {
                        const stats = data.stats;
                        const statsBar = document.getElementById('statsBar');
                        
                        statsBar.innerHTML = `
                            <div class="stat-item">
                                <div class="stat-value">${stats.total_orders}</div>
                                <div class="stat-label">–í—Å–µ–≥–æ –∑–∞–∫–∞–∑–æ–≤</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${stats.pending_orders}</div>
                                <div class="stat-label">–û–∂–∏–¥–∞—é—Ç –æ–ø–ª–∞—Ç—ã</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${stats.in_progress_orders}</div>
                                <div class="stat-label">–í —Ä–∞–±–æ—Ç–µ</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value">${stats.completed_today}</div>
                                <div class="stat-label">–ó–∞–≤–µ—Ä—à–µ–Ω–æ —Å–µ–≥–æ–¥–Ω—è</div>
                            </div>
                        `;
                        
                        statsBar.style.display = 'flex';
                    }
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –¥–ª—è –ø–∞–Ω–µ–ª–∏:', error);
            }
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π
        // –í —Ñ—É–Ω–∫—Ü–∏–∏ loadRecentActivities –≤ admin.py (JavaScript —Å–µ–∫—Ü–∏—è):
async function loadRecentActivities() {
    try {
        const response = await fetch(`${API_BASE_URL}/admin/recent-activities`, {
            headers: {
                'X-Admin-ID': currentAdmin.id,
                'X-Admin-Token': currentAdmin.token,
                'ngrok-skip-browser-warning': 'true'
            }
        });
        
        if (response.ok) {
            const data = await response.json();
            if (data.success && data.activities) {
                displayRecentActivities(data.activities);
            }
        }
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π:', error);
    }
}

function displayRecentActivities(activities) {
    const tbody = document.getElementById('activitiesTable');
    tbody.innerHTML = '';
    
    if (!activities || activities.length === 0) {
        tbody.innerHTML = `
            <tr>
                <td colspan="4" style="text-align: center; padding: 40px; opacity: 0.7;">
                    <i class="fas fa-history" style="font-size: 24px; margin-bottom: 10px; display: block;"></i>
                    <div>–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π</div>
                </td>
            </tr>
        `;
        return;
    }
    
    activities.forEach(activity => {
        const time = new Date(activity.created_at).toLocaleString('ru-RU');
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${time}</td>
            <td>${activity.action || '‚Äî'}</td>
            <td>${activity.order_id ? '#' + activity.order_id.substring(0, 8) : '‚Äî'}</td>
            <td>${activity.admin_name || '–°–∏—Å—Ç–µ–º–∞'}</td>
        `;
        tbody.appendChild(row);
    });
}
        
        // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤
        function applyFilters() {
            const status = document.getElementById('statusFilter').value;
            const exchange = document.getElementById('exchangeFilter').value;
            const admin = document.getElementById('adminFilter').value;
            
            filters = {};
            
            if (status) filters.status = status;
            if (exchange) filters.exchange = exchange;
            if (admin) {
                if (admin === '0') {
                    filters.admin_id = 'unassigned';
                } else {
                    filters.admin_id = admin;
                }
            }
            
            currentPage = 1;
            loadOrders();
        }
        
        // –°–±—Ä–æ—Å —Ñ–∏–ª—å—Ç—Ä–æ–≤
        function resetFilters() {
            document.getElementById('statusFilter').value = '';
            document.getElementById('exchangeFilter').value = '';
            document.getElementById('adminFilter').value = '';
            
            filters = {};
            currentPage = 1;
            loadOrders();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
        function updatePagination() {
            const prevBtn = document.getElementById('prevPageBtn');
            const nextBtn = document.getElementById('nextPageBtn');
            const pageInfo = document.getElementById('pageInfo');
            
            prevBtn.disabled = currentPage <= 1;
            nextBtn.disabled = currentPage >= totalPages;
            pageInfo.textContent = `–°—Ç—Ä–∞–Ω–∏—Ü–∞ ${currentPage} –∏–∑ ${totalPages}`;
        }
        
        // –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        function changePage(delta) {
            const newPage = currentPage + delta;
            
            if (newPage >= 1 && newPage <= totalPages) {
                currentPage = newPage;
                loadOrders();
                
                // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ –Ω–∞—á–∞–ª—É —Å–ø–∏—Å–∫–∞
                document.getElementById('ordersGrid').scrollIntoView({ behavior: 'smooth' });
            }
        }
        
        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–∏—Å–∫–∞
function setupSearch() {
    const searchInput = document.getElementById('searchInput');
    let searchTimeout;
    
    searchInput.addEventListener('input', function() {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∞–∫—Ç–∏–≤–Ω–∞ –ª–∏ –≤–∫–ª–∞–¥–∫–∞ –∑–∞–∫–∞–∑–æ–≤
        const ordersSection = document.getElementById('ordersSection');
        if (!ordersSection || ordersSection.style.display === 'none') {
            return;
        }
        
        clearTimeout(searchTimeout);
        searchTimeout = setTimeout(() => {
            const searchTerm = this.value.trim();
            if (searchTerm) {
                filters.search = searchTerm;
            } else {
                delete filters.search;
            }
            currentPage = 1;
            loadOrders();
        }, 500);
    });
}
        
        // –î–µ–±–∞—É–Ω—Å —Ñ—É–Ω–∫—Ü–∏—è
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
        function updateCurrentTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('ru-RU', {
                hour: '2-digit',
                minute: '2-digit'
            });
            document.getElementById('currentTime').textContent = timeString;
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        function updateOrdersBadge() {
            const badge = document.getElementById('ordersBadge');
            let unreadCount = 0;
            
            // –ü–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ–º –Ω–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
            orders.forEach(order => {
                if (order.unread_messages > 0) {
                    unreadCount += order.unread_messages;
                }
            });
            
            if (unreadCount > 0) {
                badge.textContent = unreadCount > 99 ? '99+' : unreadCount;
                badge.style.display = 'flex';
            } else {
                badge.style.display = 'none';
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        function showNotification(title, message, type = 'info') {
            const container = document.getElementById('notificationContainer');
            
            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            
            const icon = {
                'success': 'check-circle',
                'error': 'exclamation-circle',
                'warning': 'exclamation-triangle',
                'info': 'info-circle'
            }[type] || 'info-circle';
            
            notification.innerHTML = `
                <div class="notification-icon">
                    <i class="fas fa-${icon}"></i>
                </div>
                <div class="notification-content">
                    <div class="notification-title">${title}</div>
                    <div class="notification-message">${message}</div>
                </div>
                <button class="notification-close" onclick="this.parentElement.remove()">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            container.appendChild(notification);
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 5000);
        }
        
        // –ü—Ä–æ–∏–≥—Ä–∞—Ç—å –∑–≤—É–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function playNotificationSound() {
            try {
                if (!notificationSound) {
                    notificationSound = new Audio('data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAZGF0YQQAAAAAAA==');
                }
                notificationSound.play().catch(() => {
                    // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
                });
            } catch (error) {
                // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –æ—à–∏–±–∫–∏
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞, –Ω—É–∂–Ω–æ –ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        function shouldShowNotification(type) {
            const settings = {
                newOrders: document.getElementById('notifyNewOrders')?.checked ?? true,
                newMessages: document.getElementById('notifyNewMessages')?.checked ?? true,
                verificationData: document.getElementById('notifyVerificationData')?.checked ?? true
            };
            
            return settings[type] !== false;
        }
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
        function loadStoredSettings() {
            // –ü—Å–µ–≤–¥–æ–Ω–∏–º
            const nickname = localStorage.getItem('admin_nickname');
            if (nickname && document.getElementById('nicknameInput')) {
                document.getElementById('nicknameInput').value = nickname;
            }
            
            // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
            const notifyNewOrders = localStorage.getItem('notifyNewOrders') !== 'false';
            const notifyNewMessages = localStorage.getItem('notifyNewMessages') !== 'false';
            const notifyVerificationData = localStorage.getItem('notifyVerificationData') !== 'false';
            
            if (document.getElementById('notifyNewOrders')) {
                document.getElementById('notifyNewOrders').checked = notifyNewOrders;
            }
            if (document.getElementById('notifyNewMessages')) {
                document.getElementById('notifyNewMessages').checked = notifyNewMessages;
            }
            if (document.getElementById('notifyVerificationData')) {
                document.getElementById('notifyVerificationData').checked = notifyVerificationData;
            }
            
            // –¢–µ–º–∞
            const theme = localStorage.getItem('admin_theme') || 'dark';
            if (document.getElementById('themeSelect')) {
                document.getElementById('themeSelect').value = theme;
                applyTheme(theme);
            }
            
            // –ü–ª–æ—Ç–Ω–æ—Å—Ç—å
            const density = localStorage.getItem('admin_density') || 'comfortable';
            if (document.getElementById('densitySelect')) {
                document.getElementById('densitySelect').value = density;
                applyDensity(density);
            }
        }
        
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
        async function saveSettings() {
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Å–µ–≤–¥–æ–Ω–∏–º
            const nickname = document.getElementById('nicknameInput').value.trim();
            if (nickname && nickname !== currentAdmin.nickname) {
                try {
                    const response = await fetch(`${API_BASE_URL}/admin/update-nickname`, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-Admin-ID': currentAdmin.id,
                            'X-Admin-Token': currentAdmin.token,
                            'ngrok-skip-browser-warning': 'true'
                        },
                        body: JSON.stringify({
                            admin_id: parseInt(currentAdmin.id),
                            nickname: nickname
                        })
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        if (data.success) {
                            currentAdmin.nickname = nickname;
                            localStorage.setItem('admin_nickname', nickname);
                            document.getElementById('adminNickname').textContent = nickname;
                            showNotification('–£—Å–ø–µ—à–Ω–æ', '–ü—Å–µ–≤–¥–æ–Ω–∏–º –æ–±–Ω–æ–≤–ª–µ–Ω', 'success');
                        }
                    }
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Å–µ–≤–¥–æ–Ω–∏–º–∞:', error);
                    showNotification('–û—à–∏–±–∫–∞', '–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å –ø—Å–µ–≤–¥–æ–Ω–∏–º', 'error');
                }
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
            localStorage.setItem('notifyNewOrders', document.getElementById('notifyNewOrders').checked);
            localStorage.setItem('notifyNewMessages', document.getElementById('notifyNewMessages').checked);
            localStorage.setItem('notifyVerificationData', document.getElementById('notifyVerificationData').checked);
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–º—É
            const theme = document.getElementById('themeSelect').value;
            localStorage.setItem('admin_theme', theme);
            applyTheme(theme);
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–ª–æ—Ç–Ω–æ—Å—Ç—å
            const density = document.getElementById('densitySelect').value;
            localStorage.setItem('admin_density', density);
            applyDensity(density);
            
            showNotification('–£—Å–ø–µ—à–Ω–æ', '–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã', 'success');
        }
        
        // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–º—ã
        function applyTheme(theme) {
            if (theme === 'light') {
                document.documentElement.style.setProperty('--dark-bg', '#f5f5f7');
                document.documentElement.style.setProperty('--card-bg', 'rgba(255, 255, 255, 0.9)');
                document.documentElement.style.setProperty('--border-color', 'rgba(0, 0, 0, 0.1)');
                document.body.style.color = '#333';
            } else {
                document.documentElement.style.setProperty('--dark-bg', '#0a0a1a');
                document.documentElement.style.setProperty('--card-bg', 'rgba(255, 255, 255, 0.07)');
                document.documentElement.style.setProperty('--border-color', 'rgba(102, 126, 234, 0.2)');
                document.body.style.color = '#fff';
            }
        }
        
        // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏
        function applyDensity(density) {
            if (density === 'compact') {
                document.documentElement.style.setProperty('--sidebar-width', '200px');
                document.body.style.fontSize = '13px';
            } else {
                document.documentElement.style.setProperty('--sidebar-width', '250px');
                document.body.style.fontSize = '14px';
            }
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫ —É–∂–µ –æ—Ç–∫—Ä—ã—Ç–æ–º—É —Å–∞–π–¥–±–∞—Ä—É
            const sidebar = document.getElementById('sidebar');
            if (sidebar && !isSidebarCollapsed) {
                sidebar.style.width = getComputedStyle(document.documentElement).getPropertyValue('--sidebar-width');
            }
        }
        
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å–∞–π–¥–±–∞—Ä–∞
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const icon = document.getElementById('sidebarToggleIcon');
            
            if (isSidebarCollapsed) {
                sidebar.classList.remove('collapsed');
                icon.classList.remove('fa-chevron-right');
                icon.classList.add('fa-chevron-left');
                sidebar.style.width = getComputedStyle(document.documentElement).getPropertyValue('--sidebar-width');
            } else {
                sidebar.classList.add('collapsed');
                icon.classList.remove('fa-chevron-left');
                icon.classList.add('fa-chevron-right');
                sidebar.style.width = '70px';
            }
            
            isSidebarCollapsed = !isSidebarCollapsed;
        }
        
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –º–µ–Ω—é
        function toggleMobileMenu() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('show');
        }
        
        // –í—ã—Ö–æ–¥ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
        async function logout() {
            try {
                const response = await fetch(`${API_BASE_URL}/admin/logout`, {
                    method: 'POST',
                    headers: {
                        'X-Admin-ID': currentAdmin.id,
                        'X-Admin-Token': currentAdmin.token,
                        'ngrok-skip-browser-warning': 'true'
                    }
                });
                
                // –û—á–∏—â–∞–µ–º localStorage –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –æ—Ç–≤–µ—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞
                localStorage.removeItem('admin_id');
                localStorage.removeItem('admin_token');
                localStorage.removeItem('admin_nickname');
                localStorage.removeItem('admin_username');
                localStorage.removeItem('admin_role');
                
                // –ó–∞–∫—Ä—ã–≤–∞–µ–º WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
                if (socket) {
                    socket.disconnect();
                }
                
                // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞
                window.location.href = '/admin-login';
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≤—ã—Ö–æ–¥–∞:', error);
                
                // –í—Å–µ —Ä–∞–≤–Ω–æ –æ—á–∏—â–∞–µ–º localStorage –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º
                localStorage.clear();
                window.location.href = '/admin-login';
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', function() {
            // –ê–¥–∞–ø—Ç–∞—Ü–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
            if (window.innerWidth <= 992) {
                document.getElementById('sidebar').classList.add('collapsed');
                isSidebarCollapsed = true;
            }
        });
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
        window.addEventListener('resize', function() {
            if (window.innerWidth <= 992) {
                document.getElementById('sidebar').classList.remove('show');
            }
        });
    </script>
</body>
</html>
