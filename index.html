<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panda Crypto Shop</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            padding: 0;
            overflow-x: hidden;
            min-height: 100vh;
        }

        .screen {
            min-height: 100vh;
            padding: 20px 16px 100px 16px;
            opacity: 0;
            animation: fadeIn 0.5s ease forwards;
        }

        .panda-mascot {
            text-align: center;
            margin-bottom: 20px;
            animation: float 3s ease-in-out infinite;
        }

        .panda-mascot svg {
            width: 120px;
            height: 120px;
            filter: drop-shadow(0 10px 30px rgba(0,0,0,0.3));
        }

        .header {
            text-align: center;
            margin-bottom: 32px;
        }

        .header h1 {
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 8px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .header p {
            color: rgba(255,255,255,0.8);
            font-size: 16px;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            animation: slideUp 0.6s ease;
        }

        .exchange-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 24px 16px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 2px solid rgba(255,255,255,0.3);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .exchange-card:active {
            transform: scale(0.95);
        }

        .exchange-logo {
            width: 56px;
            height: 56px;
            margin: 0 auto 12px;
            background: #fff;
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .exchange-logo svg {
            width: 40px;
            height: 40px;
        }

        .exchange-name {
            font-size: 16px;
            font-weight: 700;
            color: #1a1a1a;
        }

        .back-btn {
            background: rgba(255,255,255,0.2);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.3);
            border-radius: 12px;
            padding: 12px 20px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            margin-bottom: 20px;
            color: #fff;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .service-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
            animation: slideUp 0.6s ease;
        }

        .service-card {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 20px;
            cursor: pointer;
            border: 2px solid rgba(255,255,255,0.3);
            transition: all 0.3s ease;
        }

        .service-card:active {
            transform: scale(0.98);
        }

        .service-card.selected {
            border-color: #667eea;
            box-shadow: 0 8px 30px rgba(102, 126, 234, 0.4);
        }

        .service-top {
            display: flex;
            gap: 16px;
            margin-bottom: 12px;
        }

        .service-icon {
            font-size: 40px;
        }

        .service-title {
            font-size: 18px;
            font-weight: 700;
            color: #1a1a1a;
            margin-bottom: 6px;
        }

        .service-desc {
            font-size: 14px;
            color: #666;
        }

        .service-bottom {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid rgba(0,0,0,0.08);
        }

        .service-price {
            font-size: 24px;
            font-weight: 800;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .service-badge {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            padding: 6px 12px;
            border-radius: 10px;
            font-size: 12px;
            font-weight: 700;
        }

        .crypto-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 20px 0;
        }

        .crypto-card {
            background: rgba(255,255,255,0.95);
            border-radius: 16px;
            padding: 18px 12px;
            cursor: pointer;
            border: 2px solid rgba(255,255,255,0.3);
            text-align: center;
            transition: all 0.3s ease;
        }

        .crypto-card:active {
            transform: scale(0.92);
        }

        .crypto-card.selected {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.2);
        }

        .crypto-icon {
            font-size: 36px;
            margin-bottom: 8px;
        }

        .crypto-name {
            font-size: 14px;
            font-weight: 700;
            color: #1a1a1a;
        }

        .network-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }

        .network-card {
            background: rgba(255,255,255,0.95);
            border-radius: 16px;
            padding: 16px;
            cursor: pointer;
            border: 2px solid rgba(255,255,255,0.3);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .network-card:active {
            transform: scale(0.97);
        }

        .network-card.selected {
            border-color: #667eea;
            background: rgba(102, 126, 234, 0.2);
        }

        .network-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .network-name {
            font-size: 16px;
            font-weight: 700;
            color: #1a1a1a;
        }

        .network-desc {
            font-size: 13px;
            color: #666;
        }

        .network-badge {
            background: linear-gradient(135deg, #34c759 0%, #30a14e 100%);
            color: #fff;
            padding: 6px 12px;
            border-radius: 8px;
            font-size: 11px;
            font-weight: 700;
        }

        .summary-box {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 24px;
            margin-top: 24px;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 15px;
            color: #333;
        }

        .summary-row:last-child {
            margin-top: 16px;
            padding-top: 16px;
            border-top: 2px solid rgba(0,0,0,0.1);
            font-size: 22px;
            font-weight: 800;
            color: #667eea;
        }

        .qr-container {
            text-align: center;
            padding: 24px;
        }

        .qr-code {
            width: 280px;
            height: 280px;
            margin: 20px auto;
            padding: 20px;
            background: #fff;
            border-radius: 20px;
        }

        .wallet-address {
            background: rgba(255,255,255,0.95);
            padding: 16px;
            border-radius: 12px;
            margin: 16px 0;
            word-break: break-all;
            font-family: monospace;
            font-size: 13px;
            color: #333;
        }

        .copy-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #fff;
            border: none;
            padding: 14px 28px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            margin-top: 12px;
        }

        .payment-status {
            text-align: center;
            padding: 20px;
            margin-top: 20px;
            background: rgba(255,255,255,0.1);
            border-radius: 16px;
        }

        .status-icon {
            font-size: 64px;
            animation: pulse 2s ease-in-out infinite;
        }

        .success-screen {
            text-align: center;
            padding: 40px 20px;
        }

        .success-icon {
            font-size: 120px;
            animation: successPop 0.6s ease;
        }

        .success-title {
            font-size: 32px;
            font-weight: 800;
            margin-bottom: 12px;
        }

        .hidden {
            display: none !important;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @keyframes successPop {
            0% { transform: scale(0); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body>
    <!-- –≠–∫—Ä–∞–Ω 1: –í—ã–±–æ—Ä –±–∏—Ä–∂–∏ -->
    <div id="exchangeScreen" class="screen">
        <div class="panda-mascot">
            <svg viewBox="0 0 200 200">
                <ellipse cx="100" cy="120" rx="50" ry="60" fill="#fff"/>
                <circle cx="100" cy="70" r="45" fill="#fff"/>
                <ellipse cx="70" cy="40" rx="20" ry="25" fill="#000"/>
                <ellipse cx="130" cy="40" rx="20" ry="25" fill="#000"/>
                <ellipse cx="85" cy="65" rx="18" ry="22" fill="#000"/>
                <circle cx="88" cy="68" r="6" fill="#fff"/>
                <ellipse cx="115" cy="65" rx="18" ry="22" fill="#000"/>
                <circle cx="118" cy="68" r="6" fill="#fff"/>
                <ellipse cx="100" cy="85" rx="8" ry="6" fill="#000"/>
                <circle cx="140" cy="110" r="18" fill="#FFD700"/>
                <text x="140" y="118" font-size="20" text-anchor="middle" fill="#000" font-weight="bold">‚Çø</text>
            </svg>
        </div>
        <div class="header">
            <h1>Panda Shop</h1>
            <p>–í—ã–±–µ—Ä–∏—Ç–µ –±–∏—Ä–∂—É</p>
        </div>
        <div class="grid">
            <div class="exchange-card" data-exchange="binance">
                <div class="exchange-logo">
                    <svg viewBox="0 0 126 126">
                        <path fill="#F3BA2F" d="M38.73,53.2,32.43,47l-6.3,6.3L19.83,47l6.3-6.3L38.73,53.2M58,33.9l6.3-6.3L77,40.2l6.3-6.3,6.3,6.3L77,53.2,70.6,47,64.3,40.6ZM77.43,66.7,83.73,73l-6.3,6.3L64.3,66.1l6.3-6.3ZM58,86l-6.3,6.3L38.73,79.4l-6.3,6.3-6.3-6.3L38.73,66.7l6.3,6.3,6.3,6.3L64.3,92.3ZM32.43,66.7l6.3-6.3L45,66.7l-6.3,6.3Zm32.1-6.3,6.3-6.3L77,60.4l-6.3,6.3ZM70.6,73l6.3-6.3L83.2,73l-6.3,6.3ZM58,53.2l6.3-6.3L70.6,53.2,64.3,59.5Z"/>
                    </svg>
                </div>
                <div class="exchange-name">Binance</div>
            </div>
            <div class="exchange-card" data-exchange="bybit">
                <div class="exchange-logo">
                    <svg viewBox="0 0 100 100">
                        <circle cx="50" cy="50" r="45" fill="#F7A600"/>
                        <path d="M30 35 L50 20 L70 35 L70 65 L50 80 L30 65 Z" fill="#000"/>
                    </svg>
                </div>
                <div class="exchange-name">Bybit</div>
            </div>
            <div class="exchange-card" data-exchange="okx">
                <div class="exchange-logo">
                    <svg viewBox="0 0 100 100">
                        <rect width="100" height="100" fill="#000"/>
                        <circle cx="50" cy="50" r="35" fill="none" stroke="#FFF" stroke-width="4"/>
                    </svg>
                </div>
                <div class="exchange-name">OKX</div>
            </div>
            <div class="exchange-card" data-exchange="kraken">
                <div class="exchange-logo">
                    <svg viewBox="0 0 100 100">
                        <circle cx="50" cy="50" r="45" fill="#5741D9"/>
                        <path d="M35 60 Q50 35 65 60" fill="#FFF"/>
                    </svg>
                </div>
                <div class="exchange-name">Kraken</div>
            </div>
        </div>
    </div>

    <!-- –≠–∫—Ä–∞–Ω 2: –í—ã–±–æ—Ä —É—Å–ª—É–≥–∏ -->
    <div id="serviceScreen" class="screen hidden">
        <button class="back-btn" onclick="goToExchanges()">‚Üê –ù–∞–∑–∞–¥</button>
        <div class="header">
            <h1 id="serviceExchangeName">Binance</h1>
            <p>–í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É</p>
        </div>
        <div class="service-list">
            <div class="service-card" data-service="verification" data-price="50">
                <div class="service-top">
                    <span class="service-icon">‚úÖ</span>
                    <div>
                        <div class="service-title">–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è KYC</div>
                        <div class="service-desc">–ü–æ–ª–Ω–æ–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏</div>
                    </div>
                </div>
                <div class="service-bottom">
                    <div class="service-price">$50</div>
                    <div class="service-badge">–ü–æ–ø—É–ª—è—Ä–Ω–æ</div>
                </div>
            </div>
            <div class="service-card" data-service="api" data-price="35">
                <div class="service-top">
                    <span class="service-icon">üîë</span>
                    <div>
                        <div class="service-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∞ API</div>
                        <div class="service-desc">–ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–ª—é—á–µ–π</div>
                    </div>
                </div>
                <div class="service-bottom">
                    <div class="service-price">$35</div>
                    <div class="service-badge">–ë—ã—Å—Ç—Ä–æ</div>
                </div>
            </div>
        </div>
    </div>

    <!-- –≠–∫—Ä–∞–Ω 3: –û–ø–ª–∞—Ç–∞ -->
    <div id="paymentScreen" class="screen hidden">
        <button class="back-btn" onclick="goToServices()">‚Üê –ù–∞–∑–∞–¥</button>
        <div class="header">
            <h1>üí≥ –û–ø–ª–∞—Ç–∞</h1>
            <p>–í—ã–±–µ—Ä–∏—Ç–µ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—É</p>
        </div>
        <div class="crypto-grid">
            <div class="crypto-card" data-crypto="usdt">
                <div class="crypto-icon">üíµ</div>
                <div class="crypto-name">USDT</div>
            </div>
            <div class="crypto-card" data-crypto="btc">
                <div class="crypto-icon">‚Çø</div>
                <div class="crypto-name">Bitcoin</div>
            </div>
        </div>
        <div id="networkSection" style="display:none">
            <div class="network-list" id="networkList"></div>
        </div>
        <div class="summary-box" id="finalSummary" style="display:none">
            <div class="summary-row"><span>–ë–∏—Ä–∂–∞:</span><span id="finalExchange"></span></div>
            <div class="summary-row"><span>–£—Å–ª—É–≥–∞:</span><span id="finalService"></span></div>
            <div class="summary-row"><span>–ò—Ç–æ–≥–æ:</span><span id="finalPrice"></span></div>
        </div>
    </div>

    <!-- –≠–∫—Ä–∞–Ω 4: QR –∫–æ–¥ -->
    <div id="qrScreen" class="screen hidden">
        <div class="header">
            <h1>üì± –°–∫–∞–Ω–∏—Ä—É–π—Ç–µ QR</h1>
            <p>–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–æ—á–Ω—É—é —Å—É–º–º—É</p>
        </div>
        <div class="qr-container">
            <div class="qr-code" id="qrCode"></div>
            <div class="wallet-address" id="walletAddress">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            <button class="copy-btn" onclick="copyAddress()">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
            <div class="payment-status">
                <div class="status-icon">‚è≥</div>
                <div>–û–∂–∏–¥–∞–µ–º –æ–ø–ª–∞—Ç—É...</div>
                <div style="margin-top:12px;font-size:24px;font-weight:800" id="paymentAmount">$0</div>
            </div>
        </div>
    </div>

    <!-- –≠–∫—Ä–∞–Ω 5: –£—Å–ø–µ—Ö -->
    <div id="successScreen" class="screen hidden">
        <div class="success-screen">
            <div class="success-icon">‚úÖ</div>
            <div class="success-title">–û–ø–ª–∞—Ç–∞ –ø–æ–ª—É—á–µ–Ω–∞!</div>
            <div>–ú–µ–Ω–µ–¥–∂–µ—Ä —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏</div>
        </div>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();
        tg.BackButton.show();

        let data = {
            exchange: null,
            exchangeName: null,
            service: null,
            serviceName: null,
            price: null,
            crypto: null,
            network: null,
            walletAddress: null,
            orderId: null
        };

        const wallets = {
            'usdt-trc20': 'TXm6gEHhZXjFhzPHpHKVGYHqXeDvXxXxXx',
            'btc-bitcoin': 'bc1qxy2kgdygjrsqtzq2n0yrf2493p83kkfjhx0wlh'
        };

        const networks = {
            usdt: [{id:'trc20', name:'TRC20', desc:'TRON', fee:'–ù–∏–∑–∫–∞—è'}],
            btc: [{id:'bitcoin', name:'Bitcoin', desc:'Main', fee:'–°—Ä–µ–¥–Ω—è—è'}]
        };

        document.querySelectorAll('.exchange-card').forEach(c => {
            c.onclick = () => {
                data.exchange = c.dataset.exchange;
                data.exchangeName = c.querySelector('.exchange-name').textContent;
                showScreen('serviceScreen');
                document.getElementById('serviceExchangeName').textContent = data.exchangeName;
            };
        });

        document.querySelectorAll('.service-card').forEach(c => {
            c.onclick = () => {
                document.querySelectorAll('.service-card').forEach(x => x.classList.remove('selected'));
                c.classList.add('selected');
                data.service = c.dataset.service;
                data.serviceName = c.querySelector('.service-title').textContent;
                data.price = c.dataset.price;
                setTimeout(() => showScreen('paymentScreen'), 300);
            };
        });

        document.querySelectorAll('.crypto-card').forEach(c => {
            c.onclick = () => {
                document.querySelectorAll('.crypto-card').forEach(x => x.classList.remove('selected'));
                c.classList.add('selected');
                data.crypto = c.dataset.crypto;
                showNetworks(data.crypto);
            };
        });

        function showNetworks(crypto) {
            const list = document.getElementById('networkList');
            list.innerHTML = '';
            networks[crypto].forEach(n => {
                const div = document.createElement('div');
                div.className = 'network-card';
                div.innerHTML = `
                    <div class="network-info">
                        <div>${n.name}</div>
                    </div>
                    <div class="network-badge">${n.fee}</div>
                `;
                div.onclick = () => {
                    document.querySelectorAll('.network-card').forEach(x => x.classList.remove('selected'));
                    div.classList.add('selected');
                    data.network = n.id;
                    showSummary();
                };
                list.appendChild(div);
            });
            document.getElementById('networkSection').style.display = 'block';
        }

        function showSummary() {
            document.getElementById('finalExchange').textContent = data.exchangeName;
            document.getElementById('finalService').textContent = data.serviceName;
            document.getElementById('finalPrice').textContent = '$' + data.price;
            document.getElementById('finalSummary').style.display = 'block';
            tg.MainButton.setText('–û–ø–ª–∞—Ç–∏—Ç—å $' + data.price);
            tg.MainButton.show();
        }

        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
        }

        function goToExchanges() {
            showScreen('exchangeScreen');
            tg.MainButton.hide();
        }

        function goToServices() {
            showScreen('serviceScreen');
            tg.MainButton.hide();
        }

        function generateQR() {
            data.orderId = 'ORDER-' + Date.now();
            data.walletAddress = wallets[data.crypto + '-' + data.network];
            document.getElementById('qrCode').innerHTML = '';
            new QRCode(document.getElementById('qrCode'), {
                text: data.walletAddress,
                width: 240,
                height: 240
            });
            document.getElementById('walletAddress').textContent = data.walletAddress;
            document.getElementById('paymentAmount').textContent = '$' + data.price;
            setTimeout(paymentReceived, 15000);
        }

        function paymentReceived() {
            showScreen('successScreen');
            tg.sendData(JSON.stringify(data));
            setTimeout(() => tg.close(), 3000);
        }

        function copyAddress() {
            navigator.clipboard.writeText(data.walletAddress);
            tg.showAlert('‚úÖ –ê–¥—Ä–µ—Å —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!');
        }

        tg.MainButton.onClick(() => {
            showScreen('qrScreen');
            tg.MainButton.hide();
            generateQR();
        });

        tg.BackButton.onClick(() => {
            const current = document.querySelector('.screen:not(.hidden)').id;
            if (current === 'exchangeScreen') tg.close();
            else if (current === 'serviceScreen') goToExchanges();
            else if (current === 'paymentScreen') showScreen('serviceScreen');
            else if (current === 'qrScreen') showScreen('paymentScreen');
        });
    </script>
</body>
</html>
